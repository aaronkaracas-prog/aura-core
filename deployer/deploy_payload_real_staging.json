{
    "bundle_b64":  "77u/LyoqCiAqIEF1cmEgQ29yZSDigJQgc2luZ2xlLWZpbGUgQ2xvdWRmbGFyZSBXb3JrZXIKICogLSAvY29yZTogQ2hhdEdQVC1zdHlsZSBVSSAoc2FtZSB2aXN1YWxzKQogKiAtIC9jb3JlLmpzOiBVSSBsb2dpYyAoZXh0ZXJuYWwgSlMgc28gYnV0dG9ucyBhbHdheXMgd29yaykKICogLSAvY2hhdDogT3BlbkFJIFJlc3BvbnNlcyBBUEkgKHRleHQgKyB2aXNpb24pCiAqIC0gL3RyYW5zY3JpYmU6IE9wZW5BSSBXaGlzcGVyIHRyYW5zY3JpcHRpb24KICoKICogRklYRVMgKGxvY2tlZCBmcm9tIHlvdXIgYmFzZSk6CiAqIDEpIFVJIGJ1dHRvbnMgZGVhZDogbW92ZSBVSSBsb2dpYyB0byAvY29yZS5qcyAobm8gaW5saW5lIHNjcmlwdCkKICogMikgQ29tcG9zZXIgb3ZlcmxhcDogdXBkYXRlIHBhZGRpbmcgYmVmb3JlIHNjcm9sbAogKiAzKSBNaWM6IHByb3BlciByZWNvcmQtPnN0b3AtPmF3YWl0IGZpbmFsaXplLT4vdHJhbnNjcmliZS0+aW5zZXJ0IHRyYW5zY3JpcHQgKG5vIGF1dG8tc2VuZCkKICogNCkgVXBsb2FkOiB0aHVtYm5haWwgcHJldmlldyArIHNlbmQgd2l0aCBtZXNzYWdlICh2aXNpb24pCiAqIDUpIEltYWdlIGdlbmVyYXRpb246ICJjcmVhdGUgaW1hZ2UgLi4uIiByZXR1cm5zIGFuIGFzc2lzdGFudCBpbWFnZSB0aGF0IFVJIHJlbmRlcnMKICoKICogQUREICh0aGlzIHJvdW5kLCBmdW5jdGlvbmFsIHdpcmluZyBvbmx5OyAvY29yZSB2aXN1YWxzIHVuY2hhbmdlZCk6CiAqIDYpIC9tYWxpYnUuY2l0eSBzZXJ2ZXMgSFRNTCAoZGlyZWN0b3J5IHBhZ2UpCiAqIDcpIC9tYWxpYnUuY2l0eS9hcGkvcGxhY2VzIHByb3hpZXMgR29vZ2xlIFBsYWNlcyB1c2luZyBHT09HTEVfUExBQ0VTX0FQSV9LRVkgKHNlcnZlci1zaWRlKQogKi8KCmNvbnN0IFZFUlNJT04gPSAiQVVSQV9DT1JFX18yMDI2LTAxLTE4X19PTkVGSUxFX19DSEFUR1BUX1VJX0xPQ0tfMDRfX01BTElCVV9DSVRZXzAxX19HQVRFRklYXzAzX19ERVBMT1lfUEFZTE9BRF8wMV9fU0VMRl9ERVBMT1lfT0tfMDEiOwpjb25zdCBVSV9CVUlMRCA9ICJBVVJBX1VJX0JVSUxEX18yMDI2LTAxLTE1X18wNiI7Cgpjb25zdCBMU19USFJFQURTX0tFWSA9ICJhdXJhX3RocmVhZHNfdjEiOwpjb25zdCBMU19BQ1RJVkVfVEhSRUFEX0tFWSA9ICJhdXJhX2FjdGl2ZV90aHJlYWRfdjEiOwoKZnVuY3Rpb24gc2FmZUpzb24odGV4dCkgewogIGNvbnN0IGNsZWFuID0gKHRleHQgfHwgIiIpLnJlcGxhY2UoL15cdUZFRkYrLywgIiIpLnRyaW0oKTsKICBpZiAoIWNsZWFuKSByZXR1cm4gbnVsbDsKICB0cnkgewogICAgcmV0dXJuIEpTT04ucGFyc2UoY2xlYW4pOwogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiB7IF9fcGFyc2VfZXJyb3I6IHRydWUsIF9fcmF3OiBjbGVhbiwgX19tZXNzYWdlOiBTdHJpbmcoZSAmJiBlLm1lc3NhZ2UgPyBlLm1lc3NhZ2UgOiBlKSB9OwogIH0KfQpmdW5jdGlvbiBzYWZlU3RyKHgpIHsKICByZXR1cm4gdHlwZW9mIHggPT09ICJzdHJpbmciID8geCA6IHggPT0gbnVsbCA/ICIiIDogU3RyaW5nKHgpOwp9CgpmdW5jdGlvbiBtZXRob2ROb3RBbGxvd2VkKCkgewogIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1ldGhvZF9ub3RfYWxsb3dlZCIgfSwgNDA1LCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7Cn0KCmFzeW5jIGZ1bmN0aW9uIHJlYWRCb2R5SnNvbihyZXF1ZXN0KSB7CiAgdHJ5IHsKICAgIGNvbnN0IGNsb25lID0gcmVxdWVzdC5jbG9uZSgpOwogICAgY29uc3QgdCA9IGF3YWl0IGNsb25lLnRleHQoKTsKICAgIGNvbnN0IGogPSBzYWZlSnNvbih0KTsKICAgIHJldHVybiAoaiAmJiB0eXBlb2YgaiA9PT0gIm9iamVjdCIpID8gaiA6IHt9OwogIH0gY2F0Y2ggewogICAgcmV0dXJuIHt9OwogIH0KfQoKZnVuY3Rpb24gcGlja01vZGVsKGVudikgewogIGNvbnN0IG0gPSBzYWZlU3RyKGVudiAmJiAoZW52Lk9QRU5BSV9NT0RFTCB8fCBlbnYuQVVSQV9NT0RFTCkpOwogIHJldHVybiBtIHx8ICJncHQtNC4xLW1pbmkiOwp9CmZ1bmN0aW9uIHBpY2tBcGlLZXkoZW52KSB7CiAgY29uc3QgayA9IHNhZmVTdHIoZW52ICYmIChlbnYuT1BFTkFJX0FQSV9LRVkgfHwgZW52LkFVUkFfT1BFTkFJX0FQSV9LRVkpKTsKICByZXR1cm4gayB8fCAiIjsKfQoKZnVuY3Rpb24gd2l0aE5vQ2FjaGVIZWFkZXJzKGV4dHJhKSB7CiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oCiAgICB7CiAgICAgICJjYWNoZS1jb250cm9sIjogIm5vLXN0b3JlLCBuby1jYWNoZSwgbXVzdC1yZXZhbGlkYXRlLCBtYXgtYWdlPTAiLAogICAgICBwcmFnbWE6ICJuby1jYWNoZSIsCiAgICAgIGV4cGlyZXM6ICIwIiwKICAgIH0sCiAgICBleHRyYSB8fCB7fQogICk7Cn0KCmZ1bmN0aW9uIGpzb24ob2JqLCBzdGF0dXMgPSAyMDAsIGhlYWRlcnMgPSB7fSkgewogIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkob2JqKSwgewogICAgc3RhdHVzLAogICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7ICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIgfSwgaGVhZGVycyB8fCB7fSksCiAgfSk7Cn0KZnVuY3Rpb24gaHRtbChib2R5LCBzdGF0dXMgPSAyMDAsIGhlYWRlcnMgPSB7fSkgewogIHJldHVybiBuZXcgUmVzcG9uc2UoYm9keSwgewogICAgc3RhdHVzLAogICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7ICJjb250ZW50LXR5cGUiOiAidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IiB9LCBoZWFkZXJzIHx8IHt9KSwKICB9KTsKfQpmdW5jdGlvbiBqcyhib2R5LCBzdGF0dXMgPSAyMDAsIGhlYWRlcnMgPSB7fSkgewogIHJldHVybiBuZXcgUmVzcG9uc2UoYm9keSwgewogICAgc3RhdHVzLAogICAgaGVhZGVyczogT2JqZWN0LmFzc2lnbih7ICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vamF2YXNjcmlwdDsgY2hhcnNldD11dGYtOCIgfSwgaGVhZGVycyB8fCB7fSksCiAgfSk7Cn0KCmZ1bmN0aW9uIGlzSW1hZ2VQcm9tcHQodGV4dCkgewogIGNvbnN0IHQgPSBzYWZlU3RyKHRleHQpLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwogIGlmICghdCkgcmV0dXJuIGZhbHNlOwogIHJldHVybiAoCiAgICB0LnN0YXJ0c1dpdGgoImNyZWF0ZSBpbWFnZSIpIHx8CiAgICB0LnN0YXJ0c1dpdGgoImdlbmVyYXRlIGltYWdlIikgfHwKICAgIHQuc3RhcnRzV2l0aCgibWFrZSBhbiBpbWFnZSIpIHx8CiAgICB0LnN0YXJ0c1dpdGgoIm1ha2UgaW1hZ2UiKSB8fAogICAgdC5zdGFydHNXaXRoKCJjcmVhdGUgYW4gaW1hZ2UiKQogICk7Cn0KZnVuY3Rpb24gZXh0cmFjdEltYWdlUHJvbXB0KHRleHQpIHsKICBjb25zdCByYXcgPSBzYWZlU3RyKHRleHQpLnRyaW0oKTsKICBpZiAoIXJhdykgcmV0dXJuICIiOwogIHJldHVybiByYXcucmVwbGFjZSgvXihjcmVhdGV8Z2VuZXJhdGV8bWFrZSlccysoYW5ccyspP2ltYWdlXHMqKG9mXHMqKT8vaSwgIiIpLnRyaW0oKSB8fCByYXc7Cn0KCi8qKgogKiBPcGVuQUkgUmVzcG9uc2VzIEFQSSAodGV4dC1vbmx5IG9yIHZpc2lvbiBpbnB1dCB2aWEgZGF0YSBVUkxzKQogKi8KYXN5bmMgZnVuY3Rpb24gb3BlbmFpVGV4dChlbnYsIHVzZXJUZXh0LCBpbWFnZXNEYXRhVXJscykgewogIGNvbnN0IGFwaUtleSA9IHBpY2tBcGlLZXkoZW52KTsKICBpZiAoIWFwaUtleSkgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfYXBpX2tleSIgfTsKCiAgY29uc3QgbW9kZWwgPSBwaWNrTW9kZWwoZW52KTsKCiAgY29uc3QgdXNlckNvbnRlbnQgPSBbXTsKICB1c2VyQ29udGVudC5wdXNoKHsgdHlwZTogImlucHV0X3RleHQiLCB0ZXh0OiBzYWZlU3RyKHVzZXJUZXh0KSB9KTsKCiAgaWYgKEFycmF5LmlzQXJyYXkoaW1hZ2VzRGF0YVVybHMpICYmIGltYWdlc0RhdGFVcmxzLmxlbmd0aCkgewogICAgZm9yIChjb25zdCB1IG9mIGltYWdlc0RhdGFVcmxzKSB7CiAgICAgIGNvbnN0IHVybCA9IHNhZmVTdHIodSkudHJpbSgpOwogICAgICBpZiAoIXVybCkgY29udGludWU7CiAgICAgIHVzZXJDb250ZW50LnB1c2goeyB0eXBlOiAiaW5wdXRfaW1hZ2UiLCBpbWFnZV91cmw6IHVybCB9KTsKICAgIH0KICB9CgogIGNvbnN0IHBheWxvYWQgPSB7CiAgICBtb2RlbCwKICAgIGlucHV0OiBbCiAgICAgIHsKICAgICAgICByb2xlOiAic3lzdGVtIiwKICAgICAgICBjb250ZW50OiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICJpbnB1dF90ZXh0IiwKICAgICAgICAgICAgdGV4dDoKICAgICAgICAgICAgICAiWW91IGFyZSBBdXJhLiBCZSBjb25jaXNlLiBJZiB1c2VyIGFza3MgZm9yIEpTT04tb25seSwgcmV0dXJuIHZhbGlkIEpTT04gb25seSB3aXRoIG5vIGV4dHJhIHRleHQuIE5ldmVyIHVzZSBjb2RlIGZlbmNlcy4iLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICB9LAogICAgICB7IHJvbGU6ICJ1c2VyIiwgY29udGVudDogdXNlckNvbnRlbnQgfSwKICAgIF0sCiAgfTsKCiAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL3Jlc3BvbnNlcyIsIHsKICAgIG1ldGhvZDogIlBPU1QiLAogICAgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyBhcGlLZXksICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLAogIH0pOwoKICBjb25zdCByYXcgPSBhd2FpdCByZXNwLnRleHQoKTsKICBpZiAoIXJlc3Aub2spIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICJvcGVuYWlfZXJyb3IiLCBzdGF0dXM6IHJlc3Auc3RhdHVzLCBkZXRhaWw6IHNhZmVKc29uKHJhdykgfHwgcmF3IH07CgogIGxldCBvdXRUZXh0ID0gIiI7CiAgdHJ5IHsKICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJhdyk7CiAgICBpZiAoZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEub3V0cHV0KSkgewogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YS5vdXRwdXQpIHsKICAgICAgICBpZiAoIWl0ZW0gfHwgIUFycmF5LmlzQXJyYXkoaXRlbS5jb250ZW50KSkgY29udGludWU7CiAgICAgICAgZm9yIChjb25zdCBjIG9mIGl0ZW0uY29udGVudCkgewogICAgICAgICAgaWYgKCFjKSBjb250aW51ZTsKICAgICAgICAgIGlmIChjLnR5cGUgPT09ICJvdXRwdXRfdGV4dCIgJiYgdHlwZW9mIGMudGV4dCA9PT0gInN0cmluZyIpIG91dFRleHQgKz0gYy50ZXh0OwogICAgICAgICAgaWYgKGMudHlwZSA9PT0gInRleHQiICYmIHR5cGVvZiBjLnRleHQgPT09ICJzdHJpbmciKSBvdXRUZXh0ICs9IGMudGV4dDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmICghb3V0VGV4dCAmJiBkYXRhICYmIHR5cGVvZiBkYXRhLm91dHB1dF90ZXh0ID09PSAic3RyaW5nIikgb3V0VGV4dCA9IGRhdGEub3V0cHV0X3RleHQ7CiAgfSBjYXRjaCAoXykge30KCiAgb3V0VGV4dCA9IHNhZmVTdHIob3V0VGV4dCkudHJpbSgpOwogIGlmICghb3V0VGV4dCkgb3V0VGV4dCA9ICJbbm9fdGV4dF9vdXRwdXRdIjsKICByZXR1cm4geyBvazogdHJ1ZSwgdGV4dDogb3V0VGV4dCB9Owp9CgovKioKICogT3BlbkFJIEltYWdlIGdlbmVyYXRpb24KICovCmFzeW5jIGZ1bmN0aW9uIG9wZW5haUltYWdlKGVudiwgcHJvbXB0KSB7CiAgY29uc3QgYXBpS2V5ID0gcGlja0FwaUtleShlbnYpOwogIGlmICghYXBpS2V5KSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAibWlzc2luZ19hcGlfa2V5IiB9OwoKICBjb25zdCBwID0gc2FmZVN0cihwcm9tcHQpLnRyaW0oKTsKICBpZiAoIXApIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICJtaXNzaW5nX3Byb21wdCIgfTsKCiAgY29uc3QgcGF5bG9hZCA9IHsgbW9kZWw6ICJncHQtaW1hZ2UtMSIsIHByb21wdDogcCwgc2l6ZTogIjEwMjR4MTAyNCIgfTsKCiAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2ltYWdlcy9nZW5lcmF0aW9ucyIsIHsKICAgIG1ldGhvZDogIlBPU1QiLAogICAgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyBhcGlLZXksICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLAogIH0pOwoKICBjb25zdCByYXcgPSBhd2FpdCByZXNwLnRleHQoKTsKICBjb25zdCBqID0gc2FmZUpzb24ocmF3KTsKCiAgaWYgKCFyZXNwLm9rKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAib3BlbmFpX2ltYWdlX2Vycm9yIiwgc3RhdHVzOiByZXNwLnN0YXR1cywgZGV0YWlsOiBqIHx8IHJhdyB9OwoKICBjb25zdCBiNjQgPSBqICYmIGouZGF0YSAmJiBqLmRhdGFbMF0gJiYgdHlwZW9mIGouZGF0YVswXS5iNjRfanNvbiA9PT0gInN0cmluZyIgPyBqLmRhdGFbMF0uYjY0X2pzb24gOiAiIjsKICBpZiAoIWI2NCkgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogImltYWdlX25vX2RhdGEiLCBkZXRhaWw6IGogfHwgcmF3IH07CgogIHJldHVybiB7IG9rOiB0cnVlLCBkYXRhX3VybDogImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwiICsgYjY0IH07Cn0KCmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNoYXQocmVxdWVzdCwgZW52KSB7CiAgbGV0IGJvZHlUZXh0ID0gIiI7CiAgdHJ5IHsKICAgIGJvZHlUZXh0ID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7CiAgfSBjYXRjaCB7CiAgICByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJiYWRfcmVxdWVzdCIsIGRldGFpbDogImNhbm5vdF9yZWFkX2JvZHkiIH0sIDQwMCk7CiAgfQoKICBjb25zdCBib2R5ID0gc2FmZUpzb24oYm9keVRleHQpOwogIGlmICghYm9keSB8fCB0eXBlb2YgYm9keSAhPT0gIm9iamVjdCIpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogImJhZF9qc29uIiB9LCA0MDApOwoKICBjb25zdCB0eXBlID0gc2FmZVN0cihib2R5LnR5cGUpOwogIGlmICh0eXBlICE9PSAidGV4dCIgJiYgdHlwZSAhPT0gIm1peGVkIikgcmV0dXJuIGpzb24oeyBvazogZmFsc2UsIGVycm9yOiAidW5zdXBwb3J0ZWRfdHlwZSIsIGdvdDogdHlwZSB9LCA0MDApOwoKICBjb25zdCBpbnB1dCA9IHNhZmVTdHIoYm9keS5pbnB1dCk7CiAgaWYgKCFpbnB1dCkgcmV0dXJuIGpzb24oeyBvazogZmFsc2UsIGVycm9yOiAibWlzc2luZ19pbnB1dCIgfSwgNDAwKTsKCiAgaWYgKGlucHV0LnRyaW0oKS50b0xvd2VyQ2FzZSgpID09PSAicGluZyIpIHJldHVybiBqc29uKHsgb2s6IHRydWUsIHRleHQ6ICJwb25nIiB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKCiAgaWYgKGlzSW1hZ2VQcm9tcHQoaW5wdXQpKSB7CiAgICBjb25zdCBwcm9tcHQgPSBleHRyYWN0SW1hZ2VQcm9tcHQoaW5wdXQpOwogICAgY29uc3QgaW1nID0gYXdhaXQgb3BlbmFpSW1hZ2UoZW52LCBwcm9tcHQpOwogICAgaWYgKCFpbWcub2spIHJldHVybiBqc29uKGltZywgNTAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICByZXR1cm4ganNvbigKICAgICAgeyBvazogdHJ1ZSwga2luZDogImltYWdlIiwgaW1hZ2VfZGF0YV91cmw6IGltZy5kYXRhX3VybCwgY2FwdGlvbjogIkltYWdlIGdlbmVyYXRlZC4iIH0sCiAgICAgIDIwMCwKICAgICAgd2l0aE5vQ2FjaGVIZWFkZXJzKCkKICAgICk7CiAgfQoKICBjb25zdCBpbWFnZXMgPSBBcnJheS5pc0FycmF5KGJvZHkuaW1hZ2VzKSA/IGJvZHkuaW1hZ2VzIDogW107CiAgY29uc3Qgb3V0ID0gYXdhaXQgb3BlbmFpVGV4dChlbnYsIGlucHV0LCBpbWFnZXMpOwogIGlmICghb3V0Lm9rKSByZXR1cm4ganNvbihvdXQsIDUwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwoKICByZXR1cm4ganNvbih7IG9rOiB0cnVlLCB0ZXh0OiBvdXQudGV4dCB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKfQoKYXN5bmMgZnVuY3Rpb24gaGFuZGxlVHJhbnNjcmliZShyZXF1ZXN0LCBlbnYpIHsKICBjb25zdCBhcGlLZXkgPSBwaWNrQXBpS2V5KGVudik7CiAgaWYgKCFhcGlLZXkpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfYXBpX2tleSIgfSwgNDAwKTsKCiAgbGV0IGZvcm07CiAgdHJ5IHsKICAgIGZvcm0gPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKCk7CiAgfSBjYXRjaCB7CiAgICByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJpbnZhbGlkX2Zvcm1fZGF0YSIgfSwgNDAwKTsKICB9CgogIGNvbnN0IGZpbGUgPSBmb3JtLmdldCgiZmlsZSIpOwogIGlmICghZmlsZSkgcmV0dXJuIGpzb24oeyBvazogZmFsc2UsIGVycm9yOiAibWlzc2luZ19maWxlIiB9LCA0MDApOwoKICBjb25zdCBvdXQgPSBuZXcgRm9ybURhdGEoKTsKICBvdXQuYXBwZW5kKCJtb2RlbCIsICJ3aGlzcGVyLTEiKTsKICBvdXQuYXBwZW5kKCJmaWxlIiwgZmlsZSwgImF1ZGlvLndlYm0iKTsKCiAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2F1ZGlvL3RyYW5zY3JpcHRpb25zIiwgewogICAgbWV0aG9kOiAiUE9TVCIsCiAgICBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246ICJCZWFyZXIgIiArIGFwaUtleSB9LAogICAgYm9keTogb3V0LAogIH0pOwoKICBjb25zdCByYXcgPSBhd2FpdCByZXNwLnRleHQoKTsKICBpZiAoIXJlc3Aub2spIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm9wZW5haV9lcnJvciIsIHN0YXR1czogcmVzcC5zdGF0dXMsIGRldGFpbDogc2FmZUpzb24ocmF3KSB9LCA1MDApOwoKICB0cnkgewogICAgY29uc3QgaiA9IEpTT04ucGFyc2UocmF3KTsKICAgIGNvbnN0IHQgPSBqICYmIHR5cGVvZiBqLnRleHQgPT09ICJzdHJpbmciID8gai50ZXh0IDogIiI7CiAgICByZXR1cm4ganNvbih7IG9rOiB0cnVlLCB0ZXh0OiBzYWZlU3RyKHQpIH0sIDIwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogIH0gY2F0Y2ggewogICAgcmV0dXJuIGpzb24oeyBvazogdHJ1ZSwgdGV4dDogc2FmZVN0cihyYXcpIH0sIDIwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogIH0KfQoKLyoqCiAqIE1hbGlidS5jaXR5OiBHb29nbGUgUGxhY2VzIHByb3h5CiAqIFVzZXMgZW52LkdPT0dMRV9QTEFDRVNfQVBJX0tFWSAoYWxyZWFkeSBzZXQgcGVyIHlvdXIgbG9jaykKICovCmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU1hbGlidVBsYWNlcyhyZXF1ZXN0LCBlbnYpIHsKICBjb25zdCBrZXkgPSBzYWZlU3RyKGVudiAmJiBlbnYuR09PR0xFX1BMQUNFU19BUElfS0VZKS50cmltKCk7CiAgaWYgKCFrZXkpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfZ29vZ2xlX3BsYWNlc19hcGlfa2V5IiB9LCA1MDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKCiAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7CgogIC8vIERlZmF1bHRzOiBNYWxpYnUsIENBCiAgY29uc3QgZGVmYXVsdExhdCA9ICIzNC4wMjU5IjsKICBjb25zdCBkZWZhdWx0TG5nID0gIi0xMTguNzc5OCI7CgogIGNvbnN0IHEgPSBzYWZlU3RyKHVybC5zZWFyY2hQYXJhbXMuZ2V0KCJxIikpLnRyaW0oKTsKICBjb25zdCBtb2RlID0gc2FmZVN0cih1cmwuc2VhcmNoUGFyYW1zLmdldCgibW9kZSIpKS50cmltKCkudG9Mb3dlckNhc2UoKSB8fCAocSA/ICJ0ZXh0IiA6ICJuZWFyYnkiKTsKCiAgY29uc3QgcmFkaXVzID0gc2FmZVN0cih1cmwuc2VhcmNoUGFyYW1zLmdldCgicmFkaXVzIikpLnRyaW0oKSB8fCAiMjUwMDAiOwogIGNvbnN0IHR5cGUgPSBzYWZlU3RyKHVybC5zZWFyY2hQYXJhbXMuZ2V0KCJ0eXBlIikpLnRyaW0oKSB8fCAicmVzdGF1cmFudCI7CiAgY29uc3QgbGF0ID0gc2FmZVN0cih1cmwuc2VhcmNoUGFyYW1zLmdldCgibGF0IikpLnRyaW0oKSB8fCBkZWZhdWx0TGF0OwogIGNvbnN0IGxuZyA9IHNhZmVTdHIodXJsLnNlYXJjaFBhcmFtcy5nZXQoImxuZyIpKS50cmltKCkgfHwgZGVmYXVsdExuZzsKCiAgbGV0IGVuZHBvaW50ID0gIiI7CiAgaWYgKG1vZGUgPT09ICJ0ZXh0IikgewogICAgY29uc3QgcXVlcnkgPSBxIHx8IGAke3R5cGV9IGluIE1hbGlidSBDQWA7CiAgICBlbmRwb2ludCA9CiAgICAgICJodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvcGxhY2UvdGV4dHNlYXJjaC9qc29uIiArCiAgICAgIGA/cXVlcnk9JHtlbmNvZGVVUklDb21wb25lbnQocXVlcnkpfWAgKwogICAgICBgJmtleT0ke2VuY29kZVVSSUNvbXBvbmVudChrZXkpfWA7CiAgfSBlbHNlIHsKICAgIGVuZHBvaW50ID0KICAgICAgImh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9wbGFjZS9uZWFyYnlzZWFyY2gvanNvbiIgKwogICAgICBgP2xvY2F0aW9uPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGxhdCArICIsIiArIGxuZyl9YCArCiAgICAgIGAmcmFkaXVzPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHJhZGl1cyl9YCArCiAgICAgIGAmdHlwZT0ke2VuY29kZVVSSUNvbXBvbmVudCh0eXBlKX1gICsKICAgICAgYCZrZXk9JHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX1gOwogIH0KCiAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7IG1ldGhvZDogIkdFVCIgfSk7CiAgY29uc3QgcmF3ID0gYXdhaXQgcmVzcC50ZXh0KCk7CiAgY29uc3QgZGF0YSA9IHNhZmVKc29uKHJhdyk7CgogIGlmICghcmVzcC5vaykgewogICAgcmV0dXJuIGpzb24oCiAgICAgIHsgb2s6IGZhbHNlLCBlcnJvcjogImdvb2dsZV9wbGFjZXNfZXJyb3IiLCBzdGF0dXM6IHJlc3Auc3RhdHVzLCBkZXRhaWw6IGRhdGEgfHwgcmF3IH0sCiAgICAgIDUwMiwKICAgICAgd2l0aE5vQ2FjaGVIZWFkZXJzKCkKICAgICk7CiAgfQoKICAvLyBLZWVwIHJlc3BvbnNlIGxlYW4gYnV0IHVzYWJsZQogIGNvbnN0IHJlc3VsdHMgPSBkYXRhICYmIEFycmF5LmlzQXJyYXkoZGF0YS5yZXN1bHRzKSA/IGRhdGEucmVzdWx0cyA6IFtdOwogIGNvbnN0IHNsaW0gPSByZXN1bHRzLm1hcCgocikgPT4gKHsKICAgIHBsYWNlX2lkOiByLnBsYWNlX2lkLAogICAgbmFtZTogci5uYW1lLAogICAgcmF0aW5nOiByLnJhdGluZywKICAgIHVzZXJfcmF0aW5nc190b3RhbDogci51c2VyX3JhdGluZ3NfdG90YWwsCiAgICBwcmljZV9sZXZlbDogci5wcmljZV9sZXZlbCwKICAgIHZpY2luaXR5OiByLnZpY2luaXR5LAogICAgZm9ybWF0dGVkX2FkZHJlc3M6IHIuZm9ybWF0dGVkX2FkZHJlc3MsCiAgICBidXNpbmVzc19zdGF0dXM6IHIuYnVzaW5lc3Nfc3RhdHVzLAogICAgdHlwZXM6IHIudHlwZXMsCiAgICBnZW9tZXRyeTogci5nZW9tZXRyeSwKICAgIHBob3Rvczogci5waG90b3MsCiAgfSkpOwoKICByZXR1cm4ganNvbigKICAgIHsKICAgICAgb2s6IHRydWUsCiAgICAgIHNvdXJjZTogImdvb2dsZV9wbGFjZXMiLAogICAgICBtb2RlLAogICAgICBxdWVyeTogcSB8fCBudWxsLAogICAgICB0eXBlLAogICAgICByYWRpdXM6IE51bWJlcihyYWRpdXMpIHx8IHJhZGl1cywKICAgICAgY2VudGVyOiB7IGxhdDogTnVtYmVyKGxhdCkgfHwgbGF0LCBsbmc6IE51bWJlcihsbmcpIHx8IGxuZyB9LAogICAgICByZXN1bHRzOiBzbGltLAogICAgfSwKICAgIDIwMCwKICAgIHdpdGhOb0NhY2hlSGVhZGVycygpCiAgKTsKfQoKLyoqCiAqIE1hbGlidS5jaXR5IEhUTUwgKHNlcGFyYXRlIGZyb20gL2NvcmU7IGRvZXMgbm90IGNoYW5nZSAvY29yZSB2aXN1YWxzKQogKi8KZnVuY3Rpb24gcmVuZGVyTWFsaWJ1Q2l0eVVJKCkgewogIHJldHVybiBgPCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSIgLz4KPHRpdGxlPk1hbGlidS5jaXR5PC90aXRsZT4KPHN0eWxlPgo6cm9vdHstLWJnOiNmZmZmZmY7LS1tdXRlZDojNmI3MjgwOy0tbGluZTojZTVlN2ViOy0tc2hhZG93OjAgMXB4IDAgcmdiYSgwLDAsMCwuMDMpOy0tcGlsbDojZjNmNGY2Oy0tYmx1ZTojMjU2M2ViOy0tYmx1ZTI6IzFkNGVkOH0KaHRtbCxib2R5e2hlaWdodDoxMDAlO21hcmdpbjowO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOiMxMTE4Mjc7Zm9udC1mYW1pbHk6dWktc2Fucy1zZXJpZixzeXN0ZW0tdWksLWFwcGxlLXN5c3RlbSxTZWdvZSBVSSxSb2JvdG8sSGVsdmV0aWNhLEFyaWFsfQphe2NvbG9yOmluaGVyaXR9Ci53cmFwe21heC13aWR0aDo5ODBweDttYXJnaW46MCBhdXRvO3BhZGRpbmc6MThweCAxNnB4IDQwcHggMTZweH0KLnRvcHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4O21hcmdpbi1ib3R0b206MTRweH0KLmJyYW5ke2ZvbnQtd2VpZ2h0OjgwMDtmb250LXNpemU6MThweH0KLm1ldGF7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxMnB4fQouY2FyZHtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWxpbmUpO2JvcmRlci1yYWRpdXM6MTZweDtiYWNrZ3JvdW5kOiNmZmY7Ym94LXNoYWRvdzp2YXIoLS1zaGFkb3cpO3BhZGRpbmc6MTJweCAxMnB4fQoucm93e2Rpc3BsYXk6ZmxleDtnYXA6MTBweDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXJ9Ci5pbnB1dHtmbGV4OjE7bWluLXdpZHRoOjIyMHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tbGluZSk7Ym9yZGVyLXJhZGl1czoxNHB4O3BhZGRpbmc6MTBweCAxMnB4O2ZvbnQtc2l6ZToxNHB4O291dGxpbmU6bm9uZX0KLmJ0bntib3JkZXI6MXB4IHNvbGlkIHZhcigtLWxpbmUpO2JhY2tncm91bmQ6I2ZmZjtib3JkZXItcmFkaXVzOjE0cHg7cGFkZGluZzoxMHB4IDEycHg7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6NjUwfQouYnRuLnByaW1hcnl7YmFja2dyb3VuZDp2YXIoLS1ibHVlKTtib3JkZXItY29sb3I6dmFyKC0tYmx1ZSk7Y29sb3I6I2ZmZn0KLmJ0bi5wcmltYXJ5OmhvdmVye2JhY2tncm91bmQ6dmFyKC0tYmx1ZTIpfQouc21hbGx7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxMnB4O21hcmdpbi10b3A6MTBweH0KLmxpc3R7bWFyZ2luLXRvcDoxNHB4O2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZml0LG1pbm1heCgyODBweCwxZnIpKTtnYXA6MTJweH0KLml0ZW17Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1saW5lKTtib3JkZXItcmFkaXVzOjE2cHg7YmFja2dyb3VuZDojZmZmO2JveC1zaGFkb3c6dmFyKC0tc2hhZG93KTtwYWRkaW5nOjEycHh9Ci5uYW1le2ZvbnQtd2VpZ2h0OjgwMDttYXJnaW46MCAwIDZweCAwfQouYWRkcntjb2xvcjp2YXIoLS1tdXRlZCk7Zm9udC1zaXplOjEzcHg7bGluZS1oZWlnaHQ6MS4zNX0KLmJhZGdlc3ttYXJnaW4tdG9wOjEwcHg7ZGlzcGxheTpmbGV4O2dhcDo4cHg7ZmxleC13cmFwOndyYXB9Ci5iYWRnZXtiYWNrZ3JvdW5kOnZhcigtLXBpbGwpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tbGluZSk7Ym9yZGVyLXJhZGl1czo5OTlweDtwYWRkaW5nOjVweCA5cHg7Zm9udC1zaXplOjEycHg7Y29sb3I6IzExMTgyN30KPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICA8ZGl2IGNsYXNzPSJ3cmFwIj4KICAgIDxkaXYgY2xhc3M9InRvcCI+CiAgICAgIDxkaXYgY2xhc3M9ImJyYW5kIj5NYWxpYnUuY2l0eTwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJtZXRhIj5EaXJlY3RvcnkgKGxpdmUpPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9Im1ldGEiIHN0eWxlPSJtYXJnaW4tbGVmdDphdXRvIj5Qb3dlcmVkIGJ5IEdvb2dsZSBQbGFjZXM8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgIDxpbnB1dCBjbGFzcz0iaW5wdXQiIGlkPSJxIiBwbGFjZWhvbGRlcj0iU2VhcmNoIChlLmcuLCByZXN0YXVyYW50cywgY29mZmVlLCB0YWNvcywgc3VzaGkpIiAvPgogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InJlc3RhdXJhbnRzIj5SZXN0YXVyYW50czwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgaWQ9ImNvZmZlZSI+Q29mZmVlPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIHByaW1hcnkiIGlkPSJzZWFyY2giPlNlYXJjaDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlRpcDogdGhpcyBwYWdlIGNhbGxzIDxjb2RlPi9tYWxpYnUuY2l0eS9hcGkvcGxhY2VzPC9jb2RlPi4gS2V5IHN0YXlzIHNlcnZlci1zaWRlLjwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0ibGlzdCIgaWQ9Imxpc3QiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0ic21hbGwiIGlkPSJzdGF0dXMiPjwvZGl2PgogIDwvZGl2PgoKPHNjcmlwdD4KKCgpID0+IHsKICBjb25zdCAkID0gKGlkKSA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgY29uc3QgbGlzdCA9ICQoImxpc3QiKTsKICBjb25zdCBzdGF0dXMgPSAkKCJzdGF0dXMiKTsKICBjb25zdCBxID0gJCgicSIpOwoKICBmdW5jdGlvbiBlc2Mocyl7IHJldHVybiAoc3x8IiIpLnRvU3RyaW5nKCkucmVwbGFjZSgvWyY8PiInXS9nLCBjID0+ICh7JyYnOicmYW1wOycsJzwnOicmbHQ7JywnPic6JyZndDsnLCciJzonJnF1b3Q7JywiJyI6JyYjMzk7J31bY10pKTsgfQoKICBhc3luYyBmdW5jdGlvbiBsb2FkKHF1ZXJ5KXsKICAgIHN0YXR1cy50ZXh0Q29udGVudCA9ICJMb2FkaW5nLi4uIjsKICAgIGxpc3QuaW5uZXJIVE1MID0gIiI7CiAgICBjb25zdCB1cmwgPSAiL21hbGlidS5jaXR5L2FwaS9wbGFjZXM/bW9kZT10ZXh0JnE9IiArIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeSB8fCAicmVzdGF1cmFudHMgaW4gTWFsaWJ1IENBIik7CiAgICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2godXJsKTsKICAgIGNvbnN0IGogPSBhd2FpdCByZXNwLmpzb24oKS5jYXRjaCgoKSA9PiBudWxsKTsKICAgIGlmICghcmVzcC5vayB8fCAhaiB8fCAhai5vaykgewogICAgICBzdGF0dXMudGV4dENvbnRlbnQgPSAiRXJyb3IgbG9hZGluZyBwbGFjZXMuIjsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgaXRlbXMgPSBqLnJlc3VsdHMgfHwgW107CiAgICBzdGF0dXMudGV4dENvbnRlbnQgPSBpdGVtcy5sZW5ndGggPyAoaXRlbXMubGVuZ3RoICsgIiByZXN1bHRzIikgOiAiTm8gcmVzdWx0cy4iOwogICAgbGlzdC5pbm5lckhUTUwgPSBpdGVtcy5tYXAociA9PiB7CiAgICAgIGNvbnN0IG5hbWUgPSBlc2Moci5uYW1lIHx8ICIiKTsKICAgICAgY29uc3QgYWRkciA9IGVzYyhyLmZvcm1hdHRlZF9hZGRyZXNzIHx8IHIudmljaW5pdHkgfHwgIiIpOwogICAgICBjb25zdCByYXRpbmcgPSAoci5yYXRpbmcgIT0gbnVsbCkgPyAoIuKtkCAiICsgci5yYXRpbmcpIDogIiI7CiAgICAgIGNvbnN0IHRvdGFsID0gKHIudXNlcl9yYXRpbmdzX3RvdGFsICE9IG51bGwpID8gKCIoIiArIHIudXNlcl9yYXRpbmdzX3RvdGFsICsgIikiKSA6ICIiOwogICAgICBjb25zdCBwcmljZSA9IChyLnByaWNlX2xldmVsICE9IG51bGwpID8gKCIkIi5yZXBlYXQoTWF0aC5tYXgoMSwgTWF0aC5taW4oNCwgci5wcmljZV9sZXZlbCsxKSkpKSA6ICIiOwogICAgICByZXR1cm4gKAogICAgICAgICc8ZGl2IGNsYXNzPSJpdGVtIj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJuYW1lIj4nICsgbmFtZSArICc8L2Rpdj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJhZGRyIj4nICsgYWRkciArICc8L2Rpdj4nICsKICAgICAgICAgICc8ZGl2IGNsYXNzPSJiYWRnZXMiPicgKwogICAgICAgICAgICAocmF0aW5nID8gJzxzcGFuIGNsYXNzPSJiYWRnZSI+JyArIHJhdGluZyArICIgIiArIHRvdGFsICsgJzwvc3Bhbj4nIDogIiIpICsKICAgICAgICAgICAgKHByaWNlID8gJzxzcGFuIGNsYXNzPSJiYWRnZSI+JyArIHByaWNlICsgJzwvc3Bhbj4nIDogIiIpICsKICAgICAgICAgICc8L2Rpdj4nICsKICAgICAgICAnPC9kaXY+JwogICAgICApOwogICAgfSkuam9pbigiIik7CiAgfQoKICAkKCJzZWFyY2giKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IGxvYWQoKHEudmFsdWV8fCIiKS50cmltKCkgfHwgInJlc3RhdXJhbnRzIGluIE1hbGlidSBDQSIpKTsKICAkKCJyZXN0YXVyYW50cyIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4geyBxLnZhbHVlPSJyZXN0YXVyYW50cyBpbiBNYWxpYnUgQ0EiOyBsb2FkKHEudmFsdWUpOyB9KTsKICAkKCJjb2ZmZWUiKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsgcS52YWx1ZT0iY29mZmVlIGluIE1hbGlidSBDQSI7IGxvYWQocS52YWx1ZSk7IH0pOwoKICBxLmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCAoZSkgPT4gewogICAgaWYgKGUua2V5ID09PSAiRW50ZXIiKSBsb2FkKChxLnZhbHVlfHwiIikudHJpbSgpKTsKICB9KTsKCiAgbG9hZCgicmVzdGF1cmFudHMgaW4gTWFsaWJ1IENBIik7Cn0pKCk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD5gOwp9CgovKioKICogVUkgSFRNTDogc2FtZSB2aXN1YWxzLCBidXQgbG9hZHMgZXh0ZXJuYWwgL2NvcmUuanMKICovCmZ1bmN0aW9uIHJlbmRlclVJKCkgewogIHJldHVybiBgPCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSIgLz4KPHRpdGxlPkF1cmE8L3RpdGxlPgo8c3R5bGU+Cjpyb290ey0tYmc6I2ZmZmZmZjstLW11dGVkOiM2YjcyODA7LS1tdXRlZDI6IzljYTNhZjstLWxpbmU6I2U1ZTdlYjstLXBpbGw6I2YzZjRmNjstLXNoYWRvdzowIDFweCAwIHJnYmEoMCwwLDAsLjAzKTstLXJpbmc6MCAwIDAgM3B4IHJnYmEoNTksMTMwLDI0NiwuMTgpOy0tYmx1ZTojMjU2M2ViOy0tYmx1ZTI6IzFkNGVkOH0KaHRtbCxib2R5e2hlaWdodDoxMDAlO21hcmdpbjowO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOiMxMTE4Mjc7Zm9udC1mYW1pbHk6dWktc2Fucy1zZXJpZixzeXN0ZW0tdWksLWFwcGxlLXN5c3RlbSxTZWdvZSBVSSxSb2JvdG8sSGVsdmV0aWNhLEFyaWFsLCJBcHBsZSBDb2xvciBFbW9qaSIsIlNlZ29lIFVJIEVtb2ppIn0KYXtjb2xvcjppbmhlcml0fQouYXBwe2Rpc3BsYXk6ZmxleDtoZWlnaHQ6MTAwJX0KLnNpZGV7d2lkdGg6MjgwcHg7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1saW5lKTtiYWNrZ3JvdW5kOiNmYmZiZmM7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0KLnNpZGVUb3B7cGFkZGluZzoxNHB4IDE0cHggMTBweCAxNHB4fQouYnJhbmR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTBweDtmb250LXdlaWdodDo2NTB9Ci5icmFuZE5hbWV7Zm9udC1zaXplOjE2cHh9Ci5vbmxpbmV7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6NnB4O2NvbG9yOnZhcigtLW11dGVkKTtmb250LXdlaWdodDo1MDA7Zm9udC1zaXplOjEycHg7bWFyZ2luLWxlZnQ6YXV0b30KLmRvdHt3aWR0aDo4cHg7aGVpZ2h0OjhweDtib3JkZXItcmFkaXVzOjk5OXB4O2JhY2tncm91bmQ6IzIyYzU1ZTtib3gtc2hhZG93OjAgMCAwIDJweCByZ2JhKDM0LDE5Nyw5NCwuMTUpfQouYnV0dGVye3dpZHRoOjE4cHg7aGVpZ2h0OjE4cHg7ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtvcGFjaXR5Oi45fQouYnV0dGVyIHN2Z3t3aWR0aDoxOHB4O2hlaWdodDoxOHB4O2Rpc3BsYXk6YmxvY2s7ZmlsbDojMTExODI3fQouc2lkZVJvd3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4fQouc2lkZUJ0bntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4O3dpZHRoOjEwMCU7cGFkZGluZzoxMHB4IDEwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1saW5lKTtib3JkZXItcmFkaXVzOjE0cHg7YmFja2dyb3VuZDojZmZmO2JveC1zaGFkb3c6dmFyKC0tc2hhZG93KTtjdXJzb3I6cG9pbnRlcn0KLnBsdXN7d2lkdGg6MThweDtoZWlnaHQ6MThweDtib3JkZXItcmFkaXVzOjk5OXB4O2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7YmFja2dyb3VuZDp2YXIoLS1waWxsKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWxpbmUpO2ZvbnQtd2VpZ2h0OjcwMH0KLnNpZGVCdG4gc3Bhbntmb250LXNpemU6MTRweH0KLnByb2plY3Rze3BhZGRpbmc6OHB4IDZweCAxMnB4IDZweDtib3JkZXItdG9wOjFweCBzb2xpZCB2YXIoLS1saW5lKX0KLnNlY1RpdGxle3BhZGRpbmc6OHB4IDEwcHg7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxMnB4O2ZvbnQtd2VpZ2h0OjY1MDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA1ZW19Ci5pdGVte2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7cGFkZGluZzo5cHggMTBweDtib3JkZXItcmFkaXVzOjEycHg7Y3Vyc29yOnBvaW50ZXJ9Ci5pdGVtOmhvdmVye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMDQpfQouaXRlbS5hY3RpdmV7YmFja2dyb3VuZDpyZ2JhKDM3LDk5LDIzNSwuMTApfQouaWNve3dpZHRoOjE4cHg7aGVpZ2h0OjE4cHg7Ym9yZGVyLXJhZGl1czo2cHg7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC4wNik7ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtjb2xvcjp2YXIoLS1tdXRlZCk7Zm9udC1zaXplOjEycHh9Ci5sYWJlbHtmbGV4OjE7bWluLXdpZHRoOjA7Zm9udC1zaXplOjEzcHg7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfQoubWFpbntmbGV4OjE7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjttaW4td2lkdGg6MH0KLnRvcGJhcntoZWlnaHQ6NTRweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1saW5lKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4O3BhZGRpbmc6MCAxNnB4O2JhY2tncm91bmQ6I2ZmZn0KLnRvcGJhclRpdGxle2ZvbnQtd2VpZ2h0OjY1MH0KLm1ldGF7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxMnB4fQouY2hhdHtmbGV4OjE7b3ZlcmZsb3c6YXV0bztwYWRkaW5nOjIycHggMThweCAxNzBweCAxOHB4fQoud3JhcHttYXgtd2lkdGg6ODYwcHg7bWFyZ2luOjAgYXV0b30KLmVtcHR5e21pbi1oZWlnaHQ6NTV2aDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXJ9Ci5lbXB0eSBoMXtmb250LXNpemU6MzBweDtmb250LXdlaWdodDo2NTA7bWFyZ2luOjA7Y29sb3I6IzExMTgyN30KLm1zZ3tkaXNwbGF5OmZsZXg7Z2FwOjEycHg7bWFyZ2luOjAgMCAxNHB4IDB9Ci5hdmF0YXJ7d2lkdGg6MzJweDtoZWlnaHQ6MzJweDtib3JkZXItcmFkaXVzOjEwcHg7YmFja2dyb3VuZDpyZ2JhKDM3LDk5LDIzNSwuMDgpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtjb2xvcjojMWQ0ZWQ4O2ZvbnQtd2VpZ2h0OjgwMH0KLmJ1YmJsZXtmbGV4OjE7bWluLXdpZHRoOjB9Ci5yb2xle2ZvbnQtd2VpZ2h0OjY1MDttYXJnaW4tYm90dG9tOjZweH0KLnRleHR7d2hpdGUtc3BhY2U6cHJlLXdyYXA7bGluZS1oZWlnaHQ6MS40NTtjb2xvcjojMTExODI3fQoudXNlciAuYXZhdGFye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMDYpO2NvbG9yOiMxMTE4Mjd9Ci5pbWdNc2d7bWFyZ2luLXRvcDo4cHh9Ci5pbWdNc2cgaW1ne21heC13aWR0aDoxMDAlO2JvcmRlci1yYWRpdXM6MTRweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWxpbmUpO2Rpc3BsYXk6YmxvY2s7Ym94LXNoYWRvdzp2YXIoLS1zaGFkb3cpfQouaW1nQ2Fwe2NvbG9yOnZhcigtLW11dGVkKTtmb250LXNpemU6MTJweDttYXJnaW4tdG9wOjhweH0KLmNvbXBvc2VyV3JhcHtwb3NpdGlvbjpmaXhlZDtsZWZ0OjI4MHB4O3JpZ2h0OjA7Ym90dG9tOjA7cGFkZGluZzoxNHB4IDE2cHggMTZweCAxNnB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KHRvIHRvcCwgcmdiYSgyNTUsMjU1LDI1NSwxKSwgcmdiYSgyNTUsMjU1LDI1NSwuOTgpIDcwJSwgcmdiYSgyNTUsMjU1LDI1NSwwKSk7fQpAbWVkaWEgKG1heC13aWR0aDo5MjBweCl7IC5zaWRle3dpZHRoOjI2MHB4fSAuY29tcG9zZXJXcmFwe2xlZnQ6MjYwcHh9IH0KQG1lZGlhIChtYXgtd2lkdGg6NzIwcHgpeyAuc2lkZXtkaXNwbGF5Om5vbmV9IC5jb21wb3NlcldyYXB7bGVmdDowfSB9Ci5jb21wb3NlcnttYXgtd2lkdGg6ODYwcHg7bWFyZ2luOjAgYXV0b30KLnRodW1ic3tkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7ZmxleC13cmFwOndyYXA7bWFyZ2luOjAgMCAxMHB4IDJweH0KLnRodW1ie3dpZHRoOjg0cHg7aGVpZ2h0Ojg0cHg7Ym9yZGVyLXJhZGl1czoxNHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tbGluZSk7YmFja2dyb3VuZDojZmZmO292ZXJmbG93OmhpZGRlbjtwb3NpdGlvbjpyZWxhdGl2ZTtib3gtc2hhZG93OnZhcigtLXNoYWRvdyl9Ci50aHVtYiBpbWd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyO2Rpc3BsYXk6YmxvY2t9Ci50aHVtYiAueHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6NnB4O3JpZ2h0OjZweDt3aWR0aDoyMnB4O2hlaWdodDoyMnB4O2JvcmRlci1yYWRpdXM6OTk5cHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1saW5lKTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjk1KTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Y3Vyc29yOnBvaW50ZXI7Zm9udC13ZWlnaHQ6OTAwO2NvbG9yOiMxMTE4Mjd9Ci5ib3h7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmZsZXgtZW5kO2dhcDoxMHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tbGluZSk7YmFja2dyb3VuZDojZmZmO2JvcmRlci1yYWRpdXM6MThweDtwYWRkaW5nOjEwcHggMTJweDtib3gtc2hhZG93OnZhcigtLXNoYWRvdyl9Ci5idG57d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjEycHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1saW5lKTtiYWNrZ3JvdW5kOiNmZmY7Y3Vyc29yOnBvaW50ZXI7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfQouYnRuOmhvdmVye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMDMpfQouYnRuOmFjdGl2ZXt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxcHgpfQouaW5wdXR7ZmxleDoxO21pbi1oZWlnaHQ6MjRweDttYXgtaGVpZ2h0OjE2MHB4O3Jlc2l6ZTpub25lO2JvcmRlcjowO291dGxpbmU6MDtmb250LXNpemU6MTRweDtsaW5lLWhlaWdodDoxLjQ1O3BhZGRpbmc6N3B4IDA7Y29sb3I6IzExMTgyN30KLnNlbmR7YmFja2dyb3VuZDp2YXIoLS1ibHVlKTtib3JkZXItY29sb3I6dmFyKC0tYmx1ZSk7Y29sb3I6I2ZmZn0KLnNlbmQ6aG92ZXJ7YmFja2dyb3VuZDp2YXIoLS1ibHVlMil9Ci5zdGF0dXN7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4O2NvbG9yOnZhcigtLW11dGVkKTtmb250LXNpemU6MTJweDttYXJnaW46MTBweCA0cHggMCA0cHh9Ci5rYmR7bWFyZ2luLWxlZnQ6YXV0bztjb2xvcjp2YXIoLS1tdXRlZDIpO2ZvbnQtc2l6ZToxMnB4fQoubWljQnRuLnJlY3tib3JkZXItY29sb3I6cmdiYSgyMzksNjgsNjgsLjM1KTtiYWNrZ3JvdW5kOnJnYmEoMjM5LDY4LDY4LC4xMCl9Ci5zcXVpZ3tkaXNwbGF5Om5vbmU7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDozcHg7bWFyZ2luLWxlZnQ6NnB4O21hcmdpbi1yaWdodDo2cHg7aGVpZ2h0OjIwcHh9Ci5zcXVpZy5vbntkaXNwbGF5OmZsZXh9Ci5zcXt3aWR0aDozcHg7aGVpZ2h0OjEwcHg7Ym9yZGVyLXJhZGl1czo5OTlweDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjQ1KTthbmltYXRpb246c3EgMS4wcyBpbmZpbml0ZSBlYXNlLWluLW91dH0KLnNxOm50aC1jaGlsZCgyKXthbmltYXRpb24tZGVsYXk6LjEyc30gLnNxOm50aC1jaGlsZCgzKXthbmltYXRpb24tZGVsYXk6LjI0c30gLnNxOm50aC1jaGlsZCg0KXthbmltYXRpb24tZGVsYXk6LjM2c30gLnNxOm50aC1jaGlsZCg1KXthbmltYXRpb24tZGVsYXk6LjQ4c30gLnNxOm50aC1jaGlsZCg2KXthbmltYXRpb24tZGVsYXk6LjYwc30KQGtleWZyYW1lcyBzcXswJSwxMDAle3RyYW5zZm9ybTpzY2FsZVkoLjU1KX0gNTAle3RyYW5zZm9ybTpzY2FsZVkoMS40NSl9fQoubWVudXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206NjRweDtsZWZ0OjEwcHg7YmFja2dyb3VuZDojZmZmO2JvcmRlcjoxcHggc29saWQgdmFyKC0tbGluZSk7Ym9yZGVyLXJhZGl1czoxNHB4O2JveC1zaGFkb3c6MCAxMnB4IDMwcHggcmdiYSgwLDAsMCwuMTApO3BhZGRpbmc6NnB4O2Rpc3BsYXk6bm9uZTttaW4td2lkdGg6MjIwcHh9Ci5tZW51Lm9ue2Rpc3BsYXk6YmxvY2t9Ci5tZW51SXRlbXtkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTBweDtib3JkZXItcmFkaXVzOjEycHg7Y3Vyc29yOnBvaW50ZXJ9Ci5tZW51SXRlbTpob3ZlcntiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjA0KX0KLm1lbnVJdGVtIC5taXt3aWR0aDoyMHB4O2hlaWdodDoyMHB4O2JvcmRlci1yYWRpdXM6OHB4O2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMDYpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9Ci5tZW51SXRlbSAubXR7Zm9udC1zaXplOjEzcHh9Ci5tZW51SXRlbSAubXN7Zm9udC1zaXplOjEycHg7Y29sb3I6dmFyKC0tbXV0ZWQpO21hcmdpbi10b3A6MnB4fQoubWVudVRleHR7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0KLnN0b3BCdG57ZGlzcGxheTpub25lO2JvcmRlci1jb2xvcjpyZ2JhKDIzOSw2OCw2OCwuMzUpO2JhY2tncm91bmQ6cmdiYSgyMzksNjgsNjgsLjEwKX0KLnN0b3BCdG4ub257ZGlzcGxheTpmbGV4fQo8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5Pgo8ZGl2IGNsYXNzPSJhcHAiPgogIDxkaXYgY2xhc3M9InNpZGUiPgogICAgPGRpdiBjbGFzcz0ic2lkZVRvcCI+CiAgICAgIDxkaXYgY2xhc3M9ImJyYW5kIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzaWRlUm93IiBzdHlsZT0id2lkdGg6MTAwJSI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJicmFuZE5hbWUiPkF1cmE8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImJ1dHRlciIgYXJpYS1oaWRkZW49InRydWUiIHRpdGxlPSJBdXJhIj4KICAgICAgICAgICAgPHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHJvbGU9ImltZyIgZm9jdXNhYmxlPSJmYWxzZSIgYXJpYS1oaWRkZW49InRydWUiPjxwYXRoIGQ9Ik0xMiAxMmMtMS43IDIuNC00LjYgNC44LTcuMyA0LjhDMiAxNi44IDEgMTQuOCAxIDEyLjMgMSA5IDIuNiA2LjQgNS4xIDYuNGMyLjIgMCA0LjcgMi4xIDYuOSA1LjZ6bTAgMGMxLjcgMi40IDQuNiA0LjggNy4zIDQuOCAyLjcgMCAzLjctMiAzLjctNC41IDAtMy4zLTEuNi01LjktNC4xLTUuOS0yLjIgMC00LjcgMi4xLTYuOSA1LjZ6TTEyIDEyYy0xLjItMy44LTEuMS03LjggMS05LjQuOS0uNyAyLjEtLjYgMi42LjQuOCAxLjctLjMgNC41LTMuNiA5ek0xMiAxMmMxLjItMy44IDEuMS03LjgtMS05LjQtLjktLjctMi4xLS42LTIuNi40LS44IDEuNy4zIDQuNSAzLjYgOXoiLz48L3N2Zz4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ib25saW5lIj48c3BhbiBjbGFzcz0iZG90Ij48L3NwYW4+PHNwYW4gaWQ9InN0YXR1c1RleHQiPk9ubGluZTwvc3Bhbj48L2Rpdj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgc3R5bGU9ImhlaWdodDoxMHB4Ij48L2Rpdj4KICAgICAgPGJ1dHRvbiBjbGFzcz0ic2lkZUJ0biIgaWQ9Im5ld0NoYXRCdG4iPjxzcGFuIGNsYXNzPSJwbHVzIj4rPC9zcGFuPjxzcGFuPk5ldyBjaGF0PC9zcGFuPjwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0icHJvamVjdHMiPgogICAgICA8ZGl2IGNsYXNzPSJzZWNUaXRsZSI+UHJvamVjdHM8L2Rpdj4KICAgICAgPGRpdiBpZD0icHJvamVjdExpc3QiPjwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJzZWNUaXRsZSIgc3R5bGU9Im1hcmdpbi10b3A6OHB4Ij5DaGF0czwvZGl2PgogICAgICA8ZGl2IGlkPSJ0aHJlYWRMaXN0Ij48L2Rpdj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8ZGl2IGNsYXNzPSJtYWluIj4KICAgIDxkaXYgY2xhc3M9InRvcGJhciI+PGRpdiBjbGFzcz0idG9wYmFyVGl0bGUiPkF1cmE8L2Rpdj48ZGl2IGNsYXNzPSJtZXRhIj58ICR7VUlfQlVJTER9PC9kaXY+PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJjaGF0IiBpZD0iY2hhdCI+PGRpdiBjbGFzcz0id3JhcCI+CiAgICAgIDxkaXYgY2xhc3M9ImVtcHR5IiBpZD0iZW1wdHkiPjxoMT5Bc2sgYW55dGhpbmc8L2gxPjwvZGl2PgogICAgICA8ZGl2IGlkPSJtc2dzIj48L2Rpdj4KICAgIDwvZGl2PjwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNvbXBvc2VyV3JhcCIgaWQ9ImNvbXBvc2VyV3JhcCI+CiAgICAgIDxkaXYgY2xhc3M9ImNvbXBvc2VyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJ0aHVtYnMiIGlkPSJ0aHVtYnMiPjwvZGl2PgoKICAgICAgICA8ZGl2IGNsYXNzPSJib3giPgogICAgICAgICAgPGRpdiBzdHlsZT0icG9zaXRpb246cmVsYXRpdmUiPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJwbHVzQnRuIiB0aXRsZT0iQXR0YWNoIj4rPC9idXR0b24+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUiIGlkPSJwbHVzTWVudSI+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudUl0ZW0iIGlkPSJtZW51VXBsb2FkIj48ZGl2IGNsYXNzPSJtaSI+8J+WvDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVudVRleHQiPjxkaXYgY2xhc3M9Im10Ij5VcGxvYWQgaW1hZ2U8L2Rpdj48ZGl2IGNsYXNzPSJtcyI+QXR0YWNoIGFuZCBzZW5kPC9kaXY+PC9kaXY+CiAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPHRleHRhcmVhIGNsYXNzPSJpbnB1dCIgaWQ9ImlucHV0IiByb3dzPSIxIiBwbGFjZWhvbGRlcj0iQXNrIGFueXRoaW5nIj48L3RleHRhcmVhPgoKICAgICAgICAgIDxkaXYgY2xhc3M9InNxdWlnIiBpZD0ic3F1aWciIGFyaWEtaGlkZGVuPSJ0cnVlIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3EiPjwvZGl2PjxkaXYgY2xhc3M9InNxIj48L2Rpdj48ZGl2IGNsYXNzPSJzcSI+PC9kaXY+PGRpdiBjbGFzcz0ic3EiPjwvZGl2PjxkaXYgY2xhc3M9InNxIj48L2Rpdj48ZGl2IGNsYXNzPSJzcSI+PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gc3RvcEJ0biIgaWQ9InN0b3BCdG4iIHRpdGxlPSJTdG9wIj7ilqA8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBtaWNCdG4iIGlkPSJtaWNCdG4iIHRpdGxlPSJWb2ljZSI+8J+OpDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIHNlbmQiIGlkPSJzZW5kQnRuIiB0aXRsZT0iU2VuZCI+4p6kPC9idXR0b24+CgogICAgICAgICAgPGlucHV0IHR5cGU9ImZpbGUiIGlkPSJmaWxlSW5wdXQiIGFjY2VwdD0iaW1hZ2UvKiIgc3R5bGU9ImRpc3BsYXk6bm9uZSIgLz4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzcz0ic3RhdHVzIj48c3Bhbj4rPC9zcGFuPjxzcGFuIGlkPSJoaW50Ij5Bc2sgYW55dGhpbmc8L3NwYW4+PHNwYW4gY2xhc3M9ImtiZCI+RW50ZXIgdG8gc2VuZCDigKIgU2hpZnQrRW50ZXIgbmV3IGxpbmU8L3NwYW4+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPHNjcmlwdCBzcmM9Ii9jb3JlLmpzP3Y9JHtlbmNvZGVVUklDb21wb25lbnQoVUlfQlVJTEQpfSI+PC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPmA7Cn0KCi8qKgogKiBFeHRlcm5hbCBVSSBsb2dpYzogdGhpcyBpcyB3aGF0IG1ha2VzIGJ1dHRvbnMgd29yawogKi8KZnVuY3Rpb24gcmVuZGVyQ29yZUpzKCkgewogIHJldHVybiBgKCgpID0+IHsKICAidXNlIHN0cmljdCI7CgogIGNvbnN0IExTX1RIUkVBRFNfS0VZID0gJHtKU09OLnN0cmluZ2lmeShMU19USFJFQURTX0tFWSl9OwogIGNvbnN0IExTX0FDVElWRV9USFJFQURfS0VZID0gJHtKU09OLnN0cmluZ2lmeShMU19BQ1RJVkVfVEhSRUFEX0tFWSl9OwogIGNvbnN0IFVJX0JVSUxEID0gJHtKU09OLnN0cmluZ2lmeShVSV9CVUlMRCl9OwogIGNvbnN0IHRocmVhZFN0b3JlS2V5ID0gKGlkKSA9PiAiYXVyYV90aHJlYWRfIiArIGlkOwoKICBjb25zdCBlbENoYXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2hhdCIpOwogIGNvbnN0IGVsTXNncyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtc2dzIik7CiAgY29uc3QgZWxFbXB0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJlbXB0eSIpOwogIGNvbnN0IGVsSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5wdXQiKTsKICBjb25zdCBlbFNlbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VuZEJ0biIpOwogIGNvbnN0IGVsUGx1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwbHVzQnRuIik7CiAgY29uc3QgZWxNZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBsdXNNZW51Iik7CiAgY29uc3QgZWxNZW51VXBsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1lbnVVcGxvYWQiKTsKICBjb25zdCBlbEZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsZUlucHV0Iik7CiAgY29uc3QgZWxUaHVtYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGh1bWJzIik7CiAgY29uc3QgZWxUaHJlYWRMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRocmVhZExpc3QiKTsKICBjb25zdCBlbFByb2plY3RMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInByb2plY3RMaXN0Iik7CiAgY29uc3QgZWxOZXdDaGF0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5ld0NoYXRCdG4iKTsKICBjb25zdCBlbFN0YXR1c1RleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzVGV4dCIpOwogIGNvbnN0IGVsSGludCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoaW50Iik7CiAgY29uc3QgZWxNaWNCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWljQnRuIik7CiAgY29uc3QgZWxTdG9wQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0b3BCdG4iKTsKICBjb25zdCBlbFNxdWlnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNxdWlnIik7CgogIC8vIElmIGFueSByZXF1aXJlZCBlbGVtZW50IGlzIG1pc3NpbmcsIHN0b3Agc2lsZW50bHkgd2l0aCBhIHZpc2libGUgaGludC4KICBjb25zdCByZXF1aXJlZCA9IFtlbENoYXQsIGVsTXNncywgZWxFbXB0eSwgZWxJbnB1dCwgZWxTZW5kLCBlbFBsdXMsIGVsTWVudSwgZWxNZW51VXBsb2FkLCBlbEZpbGUsIGVsVGh1bWJzLCBlbFRocmVhZExpc3QsIGVsUHJvamVjdExpc3QsIGVsTmV3Q2hhdEJ0biwgZWxTdGF0dXNUZXh0LCBlbEhpbnQsIGVsTWljQnRuLCBlbFN0b3BCdG4sIGVsU3F1aWddOwogIGlmIChyZXF1aXJlZC5zb21lKHggPT4gIXgpKSB7CiAgICBjb25zdCBtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICBtLnN0eWxlLnBvc2l0aW9uID0gImZpeGVkIjsKICAgIG0uc3R5bGUuYm90dG9tID0gIjEycHgiOwogICAgbS5zdHlsZS5sZWZ0ID0gIjEycHgiOwogICAgbS5zdHlsZS5wYWRkaW5nID0gIjEwcHggMTJweCI7CiAgICBtLnN0eWxlLmJvcmRlciA9ICIxcHggc29saWQgI2U1ZTdlYiI7CiAgICBtLnN0eWxlLmJvcmRlclJhZGl1cyA9ICIxMnB4IjsKICAgIG0uc3R5bGUuYmFja2dyb3VuZCA9ICJ3aGl0ZSI7CiAgICBtLnN0eWxlLmZvbnRGYW1pbHkgPSAic3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBTZWdvZSBVSSwgUm9ib3RvLCBBcmlhbCI7CiAgICBtLnN0eWxlLmZvbnRTaXplID0gIjEycHgiOwogICAgbS50ZXh0Q29udGVudCA9ICJVSSBlcnJvcjogbWlzc2luZyBET00gZWxlbWVudHMuIFJlbG9hZC4iOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtKTsKICAgIHJldHVybjsKICB9CgogIGxldCBhdHRhY2htZW50cyA9IFtdOwogIGxldCBpc1JlY29yZGluZyA9IGZhbHNlOwogIGxldCBtZWRpYVJlY29yZGVyID0gbnVsbDsKICBsZXQgcmVjb3JkZWRDaHVua3MgPSBbXTsKICBsZXQgc3RvcFByb21pc2VSZXNvbHZlID0gbnVsbDsKCiAgZnVuY3Rpb24gc2V0U3RhdHVzKHQpeyBlbFN0YXR1c1RleHQudGV4dENvbnRlbnQgPSB0OyB9CiAgZnVuY3Rpb24gc2V0SGludCh0KXsgZWxIaW50LnRleHRDb250ZW50ID0gdDsgfQoKICBmdW5jdGlvbiBtYWtlSWQoKXsgcmV0dXJuICJ0XyIgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zbGljZSgyKSArIERhdGUubm93KCkudG9TdHJpbmcoMTYpOyB9CgogIGZ1bmN0aW9uIGxvYWRUaHJlYWRzKCl7CiAgICB0cnkgeyByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMU19USFJFQURTX0tFWSkgfHwgIltdIikgfHwgW107IH0gY2F0Y2ggeyByZXR1cm4gW107IH0KICB9CiAgZnVuY3Rpb24gc2F2ZVRocmVhZHMobGlzdCl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKExTX1RIUkVBRFNfS0VZLCBKU09OLnN0cmluZ2lmeShsaXN0IHx8IFtdKSk7IH0KICBmdW5jdGlvbiBnZXRBY3RpdmVUaHJlYWQoKXsgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKExTX0FDVElWRV9USFJFQURfS0VZKSB8fCAiIjsgfQogIGZ1bmN0aW9uIHNldEFjdGl2ZVRocmVhZChpZCl7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKExTX0FDVElWRV9USFJFQURfS0VZLCBpZCk7IH0KCiAgZnVuY3Rpb24gbG9hZE1lc3NhZ2VzKGlkKXsKICAgIHRyeSB7IHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRocmVhZFN0b3JlS2V5KGlkKSkgfHwgIltdIikgfHwgW107IH0gY2F0Y2ggeyByZXR1cm4gW107IH0KICB9CiAgZnVuY3Rpb24gc2F2ZU1lc3NhZ2VzKGlkLCBtc2dzKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhyZWFkU3RvcmVLZXkoaWQpLCBKU09OLnN0cmluZ2lmeShtc2dzIHx8IFtdKSk7IH0KCiAgZnVuY3Rpb24gZW5zdXJlVGhyZWFkKCl7CiAgICBsZXQgaWQgPSBnZXRBY3RpdmVUaHJlYWQoKTsKICAgIGNvbnN0IHRocmVhZHMgPSBsb2FkVGhyZWFkcygpOwogICAgaWYgKCFpZCB8fCAhdGhyZWFkcy5maW5kKHQgPT4gdC5pZCA9PT0gaWQpKSB7CiAgICAgIGlkID0gbWFrZUlkKCk7CiAgICAgIHRocmVhZHMudW5zaGlmdCh7IGlkLCB0aXRsZTogIk5ldyBjaGF0IiB9KTsKICAgICAgc2F2ZVRocmVhZHModGhyZWFkcyk7CiAgICAgIHNldEFjdGl2ZVRocmVhZChpZCk7CiAgICB9CiAgICByZXR1cm4gaWQ7CiAgfQoKICBmdW5jdGlvbiBzY3JvbGxUb0JvdHRvbSgpeyB0cnkgeyBlbENoYXQuc2Nyb2xsVG9wID0gZWxDaGF0LnNjcm9sbEhlaWdodDsgfSBjYXRjaCB7fSB9CgogIGZ1bmN0aW9uIHVwZGF0ZUNoYXRQYWQoKXsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGN3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbXBvc2VyV3JhcCIpOwogICAgICBpZiAoIWN3KSByZXR1cm47CiAgICAgIGNvbnN0IHBhZCA9IGN3Lm9mZnNldEhlaWdodCArIDI0OwogICAgICBlbENoYXQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IHBhZCArICJweCI7CiAgICB9IGNhdGNoIHt9CiAgfQoKICBmdW5jdGlvbiByZW5kZXJUaHJlYWRzKCl7CiAgICBjb25zdCB0aHJlYWRzID0gbG9hZFRocmVhZHMoKTsKICAgIGNvbnN0IGFjdGl2ZSA9IGdldEFjdGl2ZVRocmVhZCgpOwogICAgZWxUaHJlYWRMaXN0LmlubmVySFRNTCA9ICIiOwogICAgdGhyZWFkcy5mb3JFYWNoKCh0KSA9PiB7CiAgICAgIGNvbnN0IGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZC5jbGFzc05hbWUgPSAiaXRlbSIgKyAodC5pZCA9PT0gYWN0aXZlID8gIiBhY3RpdmUiIDogIiIpOwogICAgICBkLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJpY28iPvCfkqw8L2Rpdj48ZGl2IGNsYXNzPSJsYWJlbCI+PC9kaXY+JzsKICAgICAgZC5xdWVyeVNlbGVjdG9yKCIubGFiZWwiKS50ZXh0Q29udGVudCA9IHQudGl0bGUgfHwgIkNoYXQiOwogICAgICBkLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4geyBzZXRBY3RpdmVUaHJlYWQodC5pZCk7IHJlbmRlclRocmVhZHMoKTsgcmVuZGVyQ2hhdCgpOyB9KTsKICAgICAgZWxUaHJlYWRMaXN0LmFwcGVuZENoaWxkKGQpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiByZW5kZXJQcm9qZWN0cygpewogICAgY29uc3QgcHJvamVjdHMgPSBbIkF1cmEgQ29yZSIsICJNYWxpYnUuY2l0eSIsICJGcm9udERlc2suTmV0d29yayJdOwogICAgZWxQcm9qZWN0TGlzdC5pbm5lckhUTUwgPSAiIjsKICAgIHByb2plY3RzLmZvckVhY2goKHApID0+IHsKICAgICAgY29uc3QgZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBkLmNsYXNzTmFtZSA9ICJpdGVtIjsKICAgICAgZC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz0iaWNvIj7wn4+3PC9kaXY+PGRpdiBjbGFzcz0ibGFiZWwiPjwvZGl2Pic7CiAgICAgIGQucXVlcnlTZWxlY3RvcigiLmxhYmVsIikudGV4dENvbnRlbnQgPSBwOwogICAgICBlbFByb2plY3RMaXN0LmFwcGVuZENoaWxkKGQpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiByZW5kZXJDaGF0KCl7CiAgICBjb25zdCBpZCA9IGVuc3VyZVRocmVhZCgpOwogICAgY29uc3QgbXNncyA9IGxvYWRNZXNzYWdlcyhpZCk7CiAgICBlbE1zZ3MuaW5uZXJIVE1MID0gIiI7CiAgICBlbEVtcHR5LnN0eWxlLmRpc3BsYXkgPSBtc2dzLmxlbmd0aCA/ICJub25lIiA6ICJmbGV4IjsKCiAgICBtc2dzLmZvckVhY2goKG0pID0+IHsKICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIHJvdy5jbGFzc05hbWUgPSAibXNnICIgKyAobS5yb2xlID09PSAidXNlciIgPyAidXNlciIgOiAiYXNzaXN0YW50Iik7CgogICAgICBjb25zdCBhdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBhdi5jbGFzc05hbWUgPSAiYXZhdGFyIjsKICAgICAgYXYudGV4dENvbnRlbnQgPSAobS5yb2xlID09PSAidXNlciIpID8gIlkiIDogIkEiOwoKICAgICAgY29uc3QgYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBiLmNsYXNzTmFtZSA9ICJidWJibGUiOwoKICAgICAgY29uc3QgciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICByLmNsYXNzTmFtZSA9ICJyb2xlIjsKICAgICAgci50ZXh0Q29udGVudCA9IChtLnJvbGUgPT09ICJ1c2VyIikgPyAiWW91IiA6ICJBdXJhIjsKCiAgICAgIGNvbnN0IHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgdC5jbGFzc05hbWUgPSAidGV4dCI7CiAgICAgIHQudGV4dENvbnRlbnQgPSBtLnRleHQgfHwgIiI7CgogICAgICBiLmFwcGVuZENoaWxkKHIpOyBiLmFwcGVuZENoaWxkKHQpOwoKICAgICAgaWYgKG0gJiYgbS5pbWFnZURhdGFVcmwpIHsKICAgICAgICBjb25zdCB3cmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgd3JhcC5jbGFzc05hbWUgPSAiaW1nTXNnIjsKICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsKICAgICAgICBpbWcuc3JjID0gbS5pbWFnZURhdGFVcmw7CiAgICAgICAgd3JhcC5hcHBlbmRDaGlsZChpbWcpOwogICAgICAgIGlmIChtLmNhcHRpb24pIHsgY29uc3QgY2FwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7IGNhcC5jbGFzc05hbWUgPSAiaW1nQ2FwIjsgY2FwLnRleHRDb250ZW50ID0gbS5jYXB0aW9uOyB3cmFwLmFwcGVuZENoaWxkKGNhcCk7IH0KICAgICAgICBiLmFwcGVuZENoaWxkKHdyYXApOwogICAgICB9CgogICAgICByb3cuYXBwZW5kQ2hpbGQoYXYpOyByb3cuYXBwZW5kQ2hpbGQoYik7CiAgICAgIGVsTXNncy5hcHBlbmRDaGlsZChyb3cpOwogICAgfSk7CgogICAgLy8gRklYOiBwYWQgRklSU1QsIHRoZW4gc2Nyb2xsCiAgICB1cGRhdGVDaGF0UGFkKCk7CiAgICBzY3JvbGxUb0JvdHRvbSgpOwogIH0KCiAgZnVuY3Rpb24gcmVuZGVyVGh1bWJzKCl7CiAgICBlbFRodW1icy5pbm5lckhUTUwgPSAiIjsKICAgIGF0dGFjaG1lbnRzLmZvckVhY2goKGEsIGlkeCkgPT4gewogICAgICBjb25zdCBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGQuY2xhc3NOYW1lID0gInRodW1iIjsKCiAgICAgIGNvbnN0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICBpbWcuc3JjID0gYS5kYXRhVXJsOwoKICAgICAgY29uc3QgeCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB4LmNsYXNzTmFtZSA9ICJ4IjsKICAgICAgeC50ZXh0Q29udGVudCA9ICLDlyI7CiAgICAgIHguYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7IGF0dGFjaG1lbnRzLnNwbGljZShpZHgsIDEpOyByZW5kZXJUaHVtYnMoKTsgYXV0b0dyb3coKTsgdXBkYXRlQ2hhdFBhZCgpOyB9KTsKCiAgICAgIGQuYXBwZW5kQ2hpbGQoaW1nKTsgZC5hcHBlbmRDaGlsZCh4KTsKICAgICAgZWxUaHVtYnMuYXBwZW5kQ2hpbGQoZCk7CiAgICB9KTsKICAgIHVwZGF0ZUNoYXRQYWQoKTsKICB9CgogIGZ1bmN0aW9uIGF1dG9Hcm93KCl7CiAgICBlbElucHV0LnN0eWxlLmhlaWdodCA9ICIwcHgiOwogICAgY29uc3QgaGd0ID0gTWF0aC5taW4oMTYwLCBNYXRoLm1heCgyNCwgZWxJbnB1dC5zY3JvbGxIZWlnaHQpKTsKICAgIGVsSW5wdXQuc3R5bGUuaGVpZ2h0ID0gaGd0ICsgInB4IjsKICAgIHVwZGF0ZUNoYXRQYWQoKTsKICB9CgogIGZ1bmN0aW9uIGNsb3NlTWVudSgpeyBlbE1lbnUuY2xhc3NMaXN0LnJlbW92ZSgib24iKTsgfQogIGZ1bmN0aW9uIHRvZ2dsZU1lbnUoKXsgZWxNZW51LmNsYXNzTGlzdC50b2dnbGUoIm9uIik7IH0KCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoZSkgPT4gewogICAgaWYgKCFlbE1lbnUuY29udGFpbnMoZS50YXJnZXQpICYmICFlbFBsdXMuY29udGFpbnMoZS50YXJnZXQpKSBjbG9zZU1lbnUoKTsKICB9KTsKCiAgZWxQbHVzLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKGUpID0+IHsgZS5wcmV2ZW50RGVmYXVsdCgpOyB0b2dnbGVNZW51KCk7IH0pOwogIGVsTWVudVVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsgY2xvc2VNZW51KCk7IGVsRmlsZS5jbGljaygpOyB9KTsKCiAgZWxGaWxlLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIChlKSA9PiB7CiAgICBjb25zdCBmID0gKGUudGFyZ2V0LmZpbGVzICYmIGUudGFyZ2V0LmZpbGVzWzBdKSA/IGUudGFyZ2V0LmZpbGVzWzBdIDogbnVsbDsKICAgIGlmICghZikgcmV0dXJuOwoKICAgIGNvbnN0IHIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgci5vbmxvYWQgPSBmdW5jdGlvbigpewogICAgICBhdHRhY2htZW50cy5wdXNoKHsgbmFtZTogZi5uYW1lLCB0eXBlOiBmLnR5cGUsIGRhdGFVcmw6IHIucmVzdWx0IH0pOwogICAgICByZW5kZXJUaHVtYnMoKTsKICAgIH07CiAgICByLnJlYWRBc0RhdGFVUkwoZik7CiAgICBlbEZpbGUudmFsdWUgPSAiIjsKICB9KTsKCiAgYXN5bmMgZnVuY3Rpb24gc2VuZE1lc3NhZ2UodHh0KXsKICAgIGNvbnN0IGlkID0gZW5zdXJlVGhyZWFkKCk7CiAgICBjb25zdCBtc2dzID0gbG9hZE1lc3NhZ2VzKGlkKTsKICAgIGNvbnN0IG91dGdvaW5nSW1hZ2VzID0gYXR0YWNobWVudHMubWFwKGEgPT4gYS5kYXRhVXJsKS5maWx0ZXIoQm9vbGVhbik7CgogICAgbXNncy5wdXNoKHsgcm9sZTogInVzZXIiLCB0ZXh0OiB0eHQsIGltYWdlczogb3V0Z29pbmdJbWFnZXMgfSk7CiAgICBzYXZlTWVzc2FnZXMoaWQsIG1zZ3MpOwogICAgcmVuZGVyQ2hhdCgpOwogICAgc2V0SGludCgiQXVyYSBpcyB0aGlua2luZy4uLiIpOwoKICAgIGNvbnN0IHBheWxvYWQgPSBvdXRnb2luZ0ltYWdlcy5sZW5ndGggPyB7IHR5cGU6Im1peGVkIiwgaW5wdXQ6IHR4dCwgaW1hZ2VzOiBvdXRnb2luZ0ltYWdlcyB9IDogeyB0eXBlOiJ0ZXh0IiwgaW5wdXQ6IHR4dCB9OwogICAgYXR0YWNobWVudHMgPSBbXTsKICAgIHJlbmRlclRodW1icygpOwoKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCgiL2NoYXQiLCB7IG1ldGhvZDoiUE9TVCIsIGhlYWRlcnM6eyAiY29udGVudC10eXBlIjoiYXBwbGljYXRpb24vanNvbiIgfSwgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkgfSk7CiAgICAgIGNvbnN0IGogPSBhd2FpdCByZXNwLmpzb24oKTsKCiAgICAgIGlmICghaiB8fCAhai5vaykgewogICAgICAgIG1zZ3MucHVzaCh7IHJvbGU6ImFzc2lzdGFudCIsIHRleHQ6ICJbZXJyb3JdICIgKyAoaiAmJiBqLmVycm9yID8gai5lcnJvciA6ICJ1bmtub3duIikgfSk7CiAgICAgIH0gZWxzZSBpZiAoai5raW5kID09PSAiaW1hZ2UiICYmIGouaW1hZ2VfZGF0YV91cmwpIHsKICAgICAgICBtc2dzLnB1c2goeyByb2xlOiJhc3Npc3RhbnQiLCB0ZXh0OiAiIiwgaW1hZ2VEYXRhVXJsOiBqLmltYWdlX2RhdGFfdXJsLCBjYXB0aW9uOiBqLmNhcHRpb24gfHwgIiIgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbXNncy5wdXNoKHsgcm9sZToiYXNzaXN0YW50IiwgdGV4dDogai50ZXh0IH0pOwogICAgICB9CgogICAgICBzYXZlTWVzc2FnZXMoaWQsIG1zZ3MpOwogICAgICByZW5kZXJDaGF0KCk7CiAgICB9IGNhdGNoIHsKICAgICAgbXNncy5wdXNoKHsgcm9sZToiYXNzaXN0YW50IiwgdGV4dDogIltuZXR3b3JrX2Vycm9yXSIgfSk7CiAgICAgIHNhdmVNZXNzYWdlcyhpZCwgbXNncyk7CiAgICAgIHJlbmRlckNoYXQoKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHNldEhpbnQoIkFzayBhbnl0aGluZyIpOwogICAgfQogIH0KCiAgZWxTZW5kLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgY29uc3QgdiA9IChlbElucHV0LnZhbHVlIHx8ICIiKS50cmltKCk7CiAgICBpZiAoIXYgJiYgYXR0YWNobWVudHMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICBjb25zdCB0eHQgPSB2IHx8ICIgIjsKICAgIGVsSW5wdXQudmFsdWUgPSAiIjsgYXV0b0dyb3coKTsKICAgIHNlbmRNZXNzYWdlKHR4dCk7CiAgfSk7CgogIGVsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCBhdXRvR3Jvdyk7CgogIGVsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIChlKSA9PiB7CiAgICBpZiAoZS5rZXkgPT09ICJFbnRlciIgJiYgIWUuc2hpZnRLZXkpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBjb25zdCB2ID0gKGVsSW5wdXQudmFsdWUgfHwgIiIpLnRyaW0oKTsKICAgICAgaWYgKCF2ICYmIGF0dGFjaG1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwogICAgICBjb25zdCB0eHQgPSB2IHx8ICIgIjsKICAgICAgZWxJbnB1dC52YWx1ZSA9ICIiOyBhdXRvR3JvdygpOwogICAgICBzZW5kTWVzc2FnZSh0eHQpOwogICAgfQogIH0pOwoKICAvLyBWb2ljZTogcmVjb3JkIC0+IHN0b3AgLT4gYXdhaXQgcmVjb3JkZXIgc3RvcCAtPiAvdHJhbnNjcmliZSAtPiBpbnNlcnQgdHJhbnNjcmlwdCAobm8gYXV0by1zZW5kKQogIGFzeW5jIGZ1bmN0aW9uIHRyYW5zY3JpYmVBdWRpbyhibG9iLCBtaW1lVHlwZSl7CiAgICBjb25zdCBmZCA9IG5ldyBGb3JtRGF0YSgpOwogICAgY29uc3QgZmlsZW5hbWUgPSAobWltZVR5cGUgJiYgbWltZVR5cGUuaW5jbHVkZXMoIm1wNCIpKSA/ICJhdWRpby5tNGEiIDogImF1ZGlvLndlYm0iOwogICAgZmQuYXBwZW5kKCJmaWxlIiwgYmxvYiwgZmlsZW5hbWUpOwogICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKCIvdHJhbnNjcmliZSIsIHsgbWV0aG9kOiAiUE9TVCIsIGJvZHk6IGZkIH0pOwogICAgbGV0IGogPSBudWxsOwogICAgdHJ5IHsgaiA9IGF3YWl0IHJlc3AuanNvbigpOyB9IGNhdGNoIHt9CiAgICBpZiAocmVzcC5vayAmJiBqICYmIGoub2sgJiYgdHlwZW9mIGoudGV4dCA9PT0gInN0cmluZyIpIHJldHVybiBqLnRleHQ7CiAgICBjb25zdCBtc2cgPSAoaiAmJiBqLmVycm9yKSA/IGouZXJyb3IgOiAoImh0dHBfIiArIHJlc3Auc3RhdHVzKTsKICAgIHRocm93IG5ldyBFcnJvcihtc2cpOwogIH0KCiAgZnVuY3Rpb24gd2FpdEZvclN0b3AoKXsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4geyBzdG9wUHJvbWlzZVJlc29sdmUgPSByZXNvbHZlOyB9KTsKICB9CgogIGFzeW5jIGZ1bmN0aW9uIHN0YXJ0UmVjb3JkaW5nKCl7CiAgICBpZiAoaXNSZWNvcmRpbmcpIHJldHVybjsKICAgIGlmICghbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyB8fCAhbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpIHsgYWxlcnQoIk1pYyBub3Qgc3VwcG9ydGVkLiIpOyByZXR1cm47IH0KICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUgfSk7CgogICAgcmVjb3JkZWRDaHVua3MgPSBbXTsKICAgIHN0b3BQcm9taXNlUmVzb2x2ZSA9IG51bGw7CgogICAgbWVkaWFSZWNvcmRlciA9IG5ldyBNZWRpYVJlY29yZGVyKHN0cmVhbSk7CiAgICBtZWRpYVJlY29yZGVyLm9uZGF0YWF2YWlsYWJsZSA9IChldikgPT4geyBpZiAoZXYgJiYgZXYuZGF0YSAmJiBldi5kYXRhLnNpemUgPiAwKSByZWNvcmRlZENodW5rcy5wdXNoKGV2LmRhdGEpOyB9OwogICAgbWVkaWFSZWNvcmRlci5vbnN0b3AgPSAoKSA9PiB7CiAgICAgIHRyeSB7IHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0KSA9PiB0LnN0b3AoKSk7IH0gY2F0Y2gge30KICAgICAgaWYgKHR5cGVvZiBzdG9wUHJvbWlzZVJlc29sdmUgPT09ICJmdW5jdGlvbiIpIHsgY29uc3QgciA9IHN0b3BQcm9taXNlUmVzb2x2ZTsgc3RvcFByb21pc2VSZXNvbHZlID0gbnVsbDsgcigpOyB9CiAgICB9OwoKICAgIG1lZGlhUmVjb3JkZXIuc3RhcnQoKTsKICAgIGlzUmVjb3JkaW5nID0gdHJ1ZTsKICAgIGVsU3F1aWcuY2xhc3NMaXN0LmFkZCgib24iKTsKICAgIGVsU3RvcEJ0bi5jbGFzc0xpc3QuYWRkKCJvbiIpOwogICAgZWxNaWNCdG4uY2xhc3NMaXN0LmFkZCgicmVjIik7CiAgICBlbFNlbmQuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIHNldFN0YXR1cygiTGlzdGVuaW5nLi4uIik7CiAgICB1cGRhdGVDaGF0UGFkKCk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiBzdG9wUmVjb3JkaW5nKCl7CiAgICBpZiAoIWlzUmVjb3JkaW5nKSByZXR1cm47CiAgICBpc1JlY29yZGluZyA9IGZhbHNlOwoKICAgIGVsU3F1aWcuY2xhc3NMaXN0LnJlbW92ZSgib24iKTsKICAgIGVsU3RvcEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCJvbiIpOwogICAgZWxNaWNCdG4uY2xhc3NMaXN0LnJlbW92ZSgicmVjIik7CiAgICBlbFNlbmQuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgIHNldFN0YXR1cygiVHJhbnNjcmliaW5nLi4uIik7CiAgICB1cGRhdGVDaGF0UGFkKCk7CgogICAgY29uc3Qgd2FpdGVyID0gd2FpdEZvclN0b3AoKTsKICAgIHRyeSB7IG1lZGlhUmVjb3JkZXIucmVxdWVzdERhdGEgJiYgbWVkaWFSZWNvcmRlci5yZXF1ZXN0RGF0YSgpOyB9IGNhdGNoIHt9CiAgICB0cnkgeyBtZWRpYVJlY29yZGVyLnN0b3AoKTsgfSBjYXRjaCB7fQogICAgdHJ5IHsgYXdhaXQgd2FpdGVyOyB9IGNhdGNoIHt9CgogICAgY29uc3QgbWltZVR5cGUgPSAocmVjb3JkZWRDaHVua3MgJiYgcmVjb3JkZWRDaHVua3NbMF0gJiYgcmVjb3JkZWRDaHVua3NbMF0udHlwZSkgPyByZWNvcmRlZENodW5rc1swXS50eXBlIDogImF1ZGlvL3dlYm0iOwogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKHJlY29yZGVkQ2h1bmtzIHx8IFtdLCB7IHR5cGU6IG1pbWVUeXBlIHx8ICJhdWRpby93ZWJtIiB9KTsKCiAgICB0cnkgewogICAgICBpZiAoIWJsb2IgfHwgIWJsb2Iuc2l6ZSkgdGhyb3cgbmV3IEVycm9yKCJlbXB0eV9hdWRpbyIpOwogICAgICBjb25zdCB0eHQgPSBhd2FpdCB0cmFuc2NyaWJlQXVkaW8oYmxvYiwgbWltZVR5cGUpOwogICAgICBjb25zdCBjbGVhbmVkID0gKHR4dCB8fCAiIikudHJpbSgpOwogICAgICBpZiAoY2xlYW5lZCkgZWxJbnB1dC52YWx1ZSA9IGNsZWFuZWQ7CiAgICB9IGNhdGNoIHsKICAgICAgaWYgKCEoZWxJbnB1dC52YWx1ZSB8fCAiIikudHJpbSgpKSBlbElucHV0LnZhbHVlID0gIlt2b2ljZSBjYXB0dXJlZF0iOwogICAgfQoKICAgIGF1dG9Hcm93KCk7CiAgICBzZXRTdGF0dXMoIk9ubGluZSIpOwogICAgZWxJbnB1dC5mb2N1cygpOwogIH0KCiAgZWxNaWNCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICBpZiAoaXNSZWNvcmRpbmcpIHN0b3BSZWNvcmRpbmcoKTsKICAgIGVsc2Ugc3RhcnRSZWNvcmRpbmcoKS5jYXRjaCgoZSkgPT4gYWxlcnQoIk1pYyBlcnJvcjogIiArIChlICYmIGUubWVzc2FnZSA/IGUubWVzc2FnZSA6IGUpKSk7CiAgfSk7CiAgZWxTdG9wQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4geyBzdG9wUmVjb3JkaW5nKCk7IH0pOwoKICBlbE5ld0NoYXRCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICBjb25zdCBpZCA9IG1ha2VJZCgpOwogICAgY29uc3QgdGhyZWFkcyA9IGxvYWRUaHJlYWRzKCk7CiAgICB0aHJlYWRzLnVuc2hpZnQoeyBpZCwgdGl0bGU6IFVJX0JVSUxEIH0pOwogICAgc2F2ZVRocmVhZHModGhyZWFkcyk7CiAgICBzZXRBY3RpdmVUaHJlYWQoaWQpOwogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhyZWFkU3RvcmVLZXkoaWQpKTsKICAgIHJlbmRlclRocmVhZHMoKTsKICAgIHJlbmRlckNoYXQoKTsKICB9KTsKCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHVwZGF0ZUNoYXRQYWQpOwoKICBlbnN1cmVUaHJlYWQoKTsKICByZW5kZXJUaHJlYWRzKCk7CiAgcmVuZGVyUHJvamVjdHMoKTsKICByZW5kZXJDaGF0KCk7CiAgYXV0b0dyb3coKTsKICB1cGRhdGVDaGF0UGFkKCk7Cn0pKCk7YDsKfQoKZnVuY3Rpb24gZXh0cmFjdFByb3ZpZGVkQXV0aFRva2VuKHJlcXVlc3QpIHsKICAvLyBBY2NlcHQgbXVsdGlwbGUgaGVhZGVyIHN0eWxlcyB0byByZWR1Y2UgZnJpY3Rpb24gYWNyb3NzIHRvb2xzCiAgY29uc3QgYXV0aCA9IChyZXF1ZXN0LmhlYWRlcnMuZ2V0KCJhdXRob3JpemF0aW9uIikgfHwgcmVxdWVzdC5oZWFkZXJzLmdldCgiQXV0aG9yaXphdGlvbiIpIHx8ICIiKS50cmltKCk7CiAgaWYgKGF1dGgpIHsKICAgIGNvbnN0IG0gPSBhdXRoLm1hdGNoKC9eQmVhcmVyXHMrKC4rKSQvaSk7CiAgICBpZiAobSAmJiBtWzFdKSByZXR1cm4gU3RyaW5nKG1bMV0pLnRyaW0oKTsKICB9CgogIGNvbnN0IGZhbGxiYWNrcyA9IFsKICAgIHJlcXVlc3QuaGVhZGVycy5nZXQoIngtY29yZS1wYXNzIiksCiAgICByZXF1ZXN0LmhlYWRlcnMuZ2V0KCJYLUNvcmUtUGFzcyIpLAogICAgcmVxdWVzdC5oZWFkZXJzLmdldCgieC1hZG1pbi10b2tlbiIpLAogICAgcmVxdWVzdC5oZWFkZXJzLmdldCgiWC1BZG1pbi1Ub2tlbiIpLAogICAgcmVxdWVzdC5oZWFkZXJzLmdldCgieC1vcGVyYXRvci10b2tlbiIpLAogICAgcmVxdWVzdC5oZWFkZXJzLmdldCgiWC1PcGVyYXRvci1Ub2tlbiIpLAogIF07CgogIGZvciAoY29uc3QgcmF3IG9mIGZhbGxiYWNrcykgewogICAgY29uc3QgcyA9IFN0cmluZyhyYXcgfHwgIiIpLnRyaW0oKTsKICAgIGlmICghcykgY29udGludWU7CiAgICBjb25zdCBtID0gcy5tYXRjaCgvXkJlYXJlclxzKyguKykkL2kpOwogICAgaWYgKG0gJiYgbVsxXSkgcmV0dXJuIFN0cmluZyhtWzFdKS50cmltKCk7CiAgICByZXR1cm4gczsgLy8gcmF3IHRva2VuCiAgfQogIHJldHVybiAiIjsKfQoKZnVuY3Rpb24gaXNPcGVyYXRvclJlcXVlc3QocmVxdWVzdCwgZW52KSB7CiAgY29uc3QgcHJvdmlkZWQgPSBleHRyYWN0UHJvdmlkZWRBdXRoVG9rZW4ocmVxdWVzdCk7CiAgaWYgKCFwcm92aWRlZCkgcmV0dXJuIGZhbHNlOwoKICBjb25zdCBhZG1pblRva2VuID0gKGVudiAmJiBlbnYuQVVSQV9BRE1JTl9UT0tFTikgPyBTdHJpbmcoZW52LkFVUkFfQURNSU5fVE9LRU4pLnRyaW0oKSA6ICIiOwogIGNvbnN0IG9wZXJhdG9yVG9rZW4gPSAoZW52ICYmIGVudi5BVVJBX09QRVJBVE9SX1RPS0VOKSA/IFN0cmluZyhlbnYuQVVSQV9PUEVSQVRPUl9UT0tFTikudHJpbSgpIDogIiI7CgogIGlmIChhZG1pblRva2VuICYmIHByb3ZpZGVkID09PSBhZG1pblRva2VuKSByZXR1cm4gdHJ1ZTsKICBpZiAob3BlcmF0b3JUb2tlbiAmJiBwcm92aWRlZCA9PT0gb3BlcmF0b3JUb2tlbikgcmV0dXJuIHRydWU7CiAgcmV0dXJuIGZhbHNlOwp9CgoKZXhwb3J0IGRlZmF1bHQgewogIGFzeW5jIGZldGNoKHJlcXVlc3QsIGVudikgewogICAgdHJ5IHsKICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7CiAgICAgIGNvbnN0IHBhdGggPSB1cmwucGF0aG5hbWU7CgogICAgICAvLyBQcm90ZWN0IHByaXZpbGVnZWQgcHJlZml4ZXMgKGZhbGxiYWNrIGdhdGUpCiAgICAgIGlmICgKICAgICAgICBwYXRoLnN0YXJ0c1dpdGgoIi9hZG1pbiIpIHx8CiAgICAgICAgcGF0aC5zdGFydHNXaXRoKCIvb3BlcmF0b3IiKSB8fAogICAgICAgIHBhdGguc3RhcnRzV2l0aCgiL29wcyIpIHx8CiAgICAgICAgcGF0aC5zdGFydHNXaXRoKCIvaW50ZXJuYWwiKSB8fAogICAgICAgIHBhdGguc3RhcnRzV2l0aCgiL2RlcGxveWVyIikgfHwKICAgICAgICBwYXRoLnN0YXJ0c1dpdGgoIi9zZWNyZXRzIikKICAgICAgKSB7CiAgICAgICAgY29uc3Qgb2sgPSBpc09wZXJhdG9yUmVxdWVzdChyZXF1ZXN0LCBlbnYpOwogICAgICAgIGlmICghb2spIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogInVuYXV0aG9yaXplZCIgfSwgNDAxLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICAgIH0KCiAgICAgIC8vIFVJIChVTkNIQU5HRUQgdmlzdWFscykKICAgICAgaWYgKHBhdGggPT09ICIvIiB8fCBwYXRoID09PSAiL2NvcmUiKSB7CiAgICAgICAgcmV0dXJuIGh0bWwocmVuZGVyVUkoKSwgMjAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICAgIH0KICAgICAgaWYgKHBhdGggPT09ICIvY29yZS5qcyIpIHsKICAgICAgICByZXR1cm4ganMocmVuZGVyQ29yZUpzKCksIDIwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogICAgICB9CgogICAgICAvLyBIZWFsdGgvdmVyc2lvbgogICAgICBpZiAocGF0aCA9PT0gIi9oZWFsdGgiKSB7CiAgICAgICAgcmV0dXJuIGpzb24oeyBvazogdHJ1ZSwgc2VydmljZTogImF1cmEtY29yZSIsIHVpX2J1aWxkOiBVSV9CVUlMRCwgdmVyc2lvbjogVkVSU0lPTiB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQogICAgICBpZiAocGF0aCA9PT0gIi92ZXJzaW9uIikgewogICAgICAgIHJldHVybiBqc29uKHsgb2s6IHRydWUsIHNlcnZpY2U6ICJhdXJhLWNvcmUiLCB1aV9idWlsZDogVUlfQlVJTEQsIHZlcnNpb246IFZFUlNJT04gfSwgMjAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICAgIH0KICAgICAgLy8gQWRtaW4gKG9wZXJhdG9yIG9ubHkpCiAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gIkdFVCIgJiYgcGF0aCA9PT0gIi9hZG1pbi9zZWxmdGVzdCIpIHsKICAgICAgICByZXR1cm4ganNvbih7IG9rOiB0cnVlLCBhZG1pbjogdHJ1ZSwgdWlfYnVpbGQ6IFVJX0JVSUxELCB2ZXJzaW9uOiBWRVJTSU9OIH0sIDIwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogICAgICB9CiAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gIkdFVCIgJiYgcGF0aCA9PT0gIi9hZG1pbi9jYXBhYmlsaXRpZXMiKSB7CiAgICAgICAgcmV0dXJuIGpzb24oewogICAgICAgICAgb2s6IHRydWUsCiAgICAgICAgICB1aV9idWlsZDogVUlfQlVJTEQsCiAgICAgICAgICB2ZXJzaW9uOiBWRVJTSU9OLAogICAgICAgICAgY2FwYWJpbGl0aWVzOiB7CiAgICAgICAgICAgIG9wZXJhdG9yX2dhdGU6IHRydWUsCiAgICAgICAgICAgIGFkbWluX3JvdXRlczogdHJ1ZSwKICAgICAgICAgICAgc2VsZl9kZXBsb3k6IHRydWUsCiAgICAgICAgICAgIGRlcGxveWVyX2NhbGw6IHRydWUsCiAgICAgICAgICAgIHBheWxvYWRfZ2VuOiB0cnVlLAogICAgICAgICAgICBrdjogISEoZW52ICYmIChlbnYuQVVSQV9NRU0gfHwgZW52LkFVUkFfS1YpKSwKICAgICAgICAgICAgcjI6ICEhKGVudiAmJiBlbnYuQVVSQV9VUExPQURTKSwKICAgICAgICAgICAgb3BlbmFpOiAhIShlbnYgJiYgKGVudi5PUEVOQUlfQVBJX0tFWSB8fCBlbnYuQVVSQV9PUEVOQUlfQVBJX0tFWSkpLAogICAgICAgICAgICBnb29nbGVfcGxhY2VzX3Byb3h5OiAhIShlbnYgJiYgZW52LkdPT0dMRV9QTEFDRVNfQVBJX0tFWSkKICAgICAgICAgIH0KICAgICAgICB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQogICAgICBpZiAocGF0aCA9PT0gIi9hZG1pbi9zZWxmLWRlcGxveS1zdGFnaW5nIikgewogICAgICAgIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm5vdF9lbmFibGVkIiB9LCA1MDEsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQoKICAgICAgLy8gU2VsZi1kZXBsb3kgKEF1cmEgQ29yZSAtPiBhdXJhLWRlcGxveWVyIHZpYSBzZXJ2aWNlIGJpbmRpbmcpCiAgICAgIGlmIChwYXRoID09PSAiL2FkbWluL3NlbGZfZGVwbG95L3ByZXBhcmUiKSB7CiAgICAgICAgaWYgKHJlcXVlc3QubWV0aG9kICE9PSAiUE9TVCIpIHJldHVybiBtZXRob2ROb3RBbGxvd2VkKCk7CiAgICAgICAgaWYgKCFlbnY/LkFVUkFfREVQTE9ZRVIpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfZGVwbG95ZXJfYmluZGluZyIgfSwgNTAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICAgICAgaWYgKCFlbnY/LkRFUExPWV9TRUNSRVQpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfREVQTE9ZX1NFQ1JFVCIgfSwgNTAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CiAgICAgICAgcmV0dXJuIGpzb24oeyBvazogdHJ1ZSB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQoKICAgICAgaWYgKHBhdGggPT09ICIvYWRtaW4vc2VsZl9kZXBsb3kvY29tbWl0IikgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gIlBPU1QiKSByZXR1cm4gbWV0aG9kTm90QWxsb3dlZCgpOwogICAgICAgIGlmICghZW52Py5BVVJBX0RFUExPWUVSKSByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJtaXNzaW5nX2RlcGxveWVyX2JpbmRpbmciIH0sIDUwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogICAgICAgIGlmICghZW52Py5ERVBMT1lfU0VDUkVUKSByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJtaXNzaW5nX0RFUExPWV9TRUNSRVQiIH0sIDUwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwoKICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVhZEJvZHlKc29uKHJlcXVlc3QpOwogICAgICAgIGNvbnN0IHNjcmlwdF9uYW1lID0gU3RyaW5nKGJvZHk/LnNjcmlwdF9uYW1lIHx8ICJhdXJhLWNvcmUtc3RhZ2luZyIpOwogICAgICAgIGNvbnN0IGJ1bmRsZV9iNjQgPSBTdHJpbmcoYm9keT8uYnVuZGxlX2I2NCB8fCAiIik7CiAgICAgICAgaWYgKCFidW5kbGVfYjY0KSByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJtaXNzaW5nX3JlcXVpcmVkX2ZpZWxkcyIsIHJlcXVpcmVkOiBbImJ1bmRsZV9iNjQiXSwgZ290OiBPYmplY3Qua2V5cyhib2R5IHx8IHt9KSB9LCA0MDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKCiAgICAgICAgLy8gRGVwbG95ZXIgcGF5bG9hZCBjb21wYXRpYmlsaXR5OiBzZW5kIHJlZHVuZGFudCBmaWVsZCBuYW1lcyB0byBtYXRjaCBkZXBsb3llciBleHBlY3RhdGlvbnMuCiAgICAgICAgLy8gKFNvbWUgZGVwbG95ZXIgYnVpbGRzIGhpc3RvcmljYWxseSB1c2VkIGRpZmZlcmVudCBrZXlzLikKICAgICAgICBjb25zdCBkZXBsb3lQYXlsb2FkID0gewogICAgICAgICAgc2NyaXB0X25hbWUsCiAgICAgICAgICBzY3JpcHROYW1lOiBzY3JpcHRfbmFtZSwKICAgICAgICAgIG5hbWU6IHNjcmlwdF9uYW1lLAogICAgICAgICAgYnVuZGxlX2I2NCwKICAgICAgICAgIGJ1bmRsZUI2NDogYnVuZGxlX2I2NCwKICAgICAgICAgIGJ1bmRsZTogYnVuZGxlX2I2NCwKICAgICAgICB9OwoKICAgICAgICBjb25zdCB1cHN0cmVhbSA9IGF3YWl0IGVudi5BVVJBX0RFUExPWUVSLmZldGNoKCJodHRwczovL2F1cmEtZGVwbG95ZXIvZGVwbG95IiwgewogICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgIC8vIFN1cHBvcnQgYm90aCBoZWFkZXIgc3R5bGVzCiAgICAgICAgICAgICJ4LWRlcGxveS1rZXkiOiBTdHJpbmcoZW52LkRFUExPWV9TRUNSRVQpLAogICAgICAgICAgICAiYXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgIiArIFN0cmluZyhlbnYuREVQTE9ZX1NFQ1JFVCkKICAgICAgICAgIH0sCiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkZXBsb3lQYXlsb2FkKQogICAgICAgIH0pOwoKICAgICAgICBjb25zdCB0eHQgPSBhd2FpdCB1cHN0cmVhbS50ZXh0KCk7CiAgICAgICAgbGV0IGpzID0gbnVsbDsKICAgICAgICB0cnkgeyBqcyA9IEpTT04ucGFyc2UodHh0KTsgfSBjYXRjaCB7fQogICAgICAgIHJldHVybiBqc29uKHsgb2s6IHRydWUsIHVwc3RyZWFtX3N0YXR1czogdXBzdHJlYW0uc3RhdHVzLCB1cHN0cmVhbToganMgfHwgeyByYXc6IHR4dCB9IH0sIDIwMCwgd2l0aE5vQ2FjaGVIZWFkZXJzKCkpOwogICAgICB9CgogICAgICAvLyBEZXBsb3llciBoZWFsdGggKHZpYSBzZXJ2aWNlIGJpbmRpbmcpCiAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gIkdFVCIgJiYgcGF0aCA9PT0gIi9hZG1pbi9kZXBsb3llci9oZWFsdGgiKSB7CiAgICAgICAgaWYgKCFlbnY/LkFVUkFfREVQTE9ZRVIpIHJldHVybiBqc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogIm1pc3NpbmdfZGVwbG95ZXJfYmluZGluZyIgfSwgNTAwLCB3aXRoTm9DYWNoZUhlYWRlcnMoKSk7CgogICAgICAgIGNvbnN0IHIgPSBhd2FpdCBlbnYuQVVSQV9ERVBMT1lFUi5mZXRjaCgiaHR0cHM6Ly9hdXJhLWRlcGxveWVyL2hlYWx0aCIsIHsKICAgICAgICAgIG1ldGhvZDogIkdFVCIsCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJjYWNoZS1jb250cm9sIjogIm5vLXN0b3JlIiwKICAgICAgICAgICAgInByYWdtYSI6ICJuby1jYWNoZSIsCiAgICAgICAgICAgICJ4LWRlcGxveS1rZXkiOiBTdHJpbmcoZW52LkRFUExPWV9TRUNSRVQgfHwgIiIpCiAgICAgICAgICB9LAogICAgICAgICAgcmVkaXJlY3Q6ICJmb2xsb3ciCiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IHQgPSBhd2FpdCByLnRleHQoKTsKCiAgICAgICAgY29uc3QgaCA9IHt9OwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiByLmhlYWRlcnMuZW50cmllcygpKSB7CiAgICAgICAgICAgIGNvbnN0IGxrID0gU3RyaW5nKGsgfHwgIiIpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIGlmIChsayA9PT0gImNvbnRlbnQtdHlwZSIgfHwgbGsgPT09ICJjZi1yYXkiIHx8IGxrID09PSAic2VydmVyIiB8fCBsayA9PT0gImNhY2hlLWNvbnRyb2wiKSB7CiAgICAgICAgICAgICAgaFtsa10gPSB2OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7fQoKICAgICAgICBsZXQgaiA9IG51bGw7CiAgICAgICAgdHJ5IHsgaiA9IEpTT04ucGFyc2UodCk7IH0gY2F0Y2ggeyBqID0gbnVsbDsgfQoKICAgICAgICByZXR1cm4ganNvbih7IG9rOiB0cnVlLCB1cHN0cmVhbTogInNlcnZpY2VfYmluZGluZzpBVVJBX0RFUExPWUVSOi9oZWFsdGgiLCBzdGF0dXM6IHIuc3RhdHVzLCBoZWFkZXJzOiBoLCBqc29uOiBqLCByYXc6IGogPyBudWxsIDogdCB9LCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQoKLy8gTWFsaWJ1LmNpdHkgKE5FVykKICAgICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSAiR0VUIiAmJiAocGF0aCA9PT0gIi9tYWxpYnUuY2l0eSIgfHwgcGF0aCA9PT0gIi9tYWxpYnUuY2l0eS8iKSkgewogICAgICAgIHJldHVybiBodG1sKHJlbmRlck1hbGlidUNpdHlVSSgpLCAyMDAsIHdpdGhOb0NhY2hlSGVhZGVycygpKTsKICAgICAgfQogICAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09ICJHRVQiICYmIHBhdGggPT09ICIvbWFsaWJ1LmNpdHkvYXBpL3BsYWNlcyIpIHsKICAgICAgICByZXR1cm4gYXdhaXQgaGFuZGxlTWFsaWJ1UGxhY2VzKHJlcXVlc3QsIGVudik7CiAgICAgIH0KCiAgICAgIC8vIE1hbGlidUNpdHkgYWxpYXMgKHB1YmxpYykg4oCUIGtlZXAgZXhpc3RpbmcgYmVoYXZpb3IKICAgICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSAiR0VUIiAmJiAocGF0aCA9PT0gIi9NYWxpYnVDaXR5IiB8fCBwYXRoID09PSAiL21hbGlidWNpdHkiKSkgewogICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwgeyBzdGF0dXM6IDMwMiwgaGVhZGVyczogd2l0aE5vQ2FjaGVIZWFkZXJzKHsgbG9jYXRpb246ICJodHRwczovL21hbGlidS5jaXR5IiB9KSB9KTsKICAgICAgfQoKICAgICAgLy8gQVBJcwogICAgICBpZiAocGF0aCA9PT0gIi90cmFuc2NyaWJlIikgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gIlBPU1QiKSByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJtZXRob2Rfbm90X2FsbG93ZWQiIH0sIDQwNSk7CiAgICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZVRyYW5zY3JpYmUocmVxdWVzdCwgZW52KTsKICAgICAgfQogICAgICBpZiAocGF0aCA9PT0gIi9jaGF0IikgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gIlBPU1QiKSByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJtZXRob2Rfbm90X2FsbG93ZWQiIH0sIDQwNSk7CiAgICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZUNoYXQocmVxdWVzdCwgZW52KTsKICAgICAgfQoKICAgICAgCiAgLy8gRElBR05PU1RJQyBST1VURSDigJQgVEVNUE9SQVJZCiAgaWYgKHBhdGggPT09ICIvX19hZG1pbl9nYXRlX2RlYnVnIikgewogICAgY29uc3QgaGVhZGVyc1NlZW4gPSB7fTsKICAgIHRyeSB7CiAgICAgIGZvciAoY29uc3QgW2ssIHZdIG9mIHJlcXVlc3QuaGVhZGVycy5lbnRyaWVzKCkpIGhlYWRlcnNTZWVuW2tdID0gdjsKICAgIH0gY2F0Y2gge30KICAgIHJldHVybiBqc29uKHsKICAgICAgb2s6IHRydWUsCiAgICAgIGRpYWdub3N0aWM6IHRydWUsCiAgICAgIHBhdGgsCiAgICAgIGhhc19lbnY6IHsKICAgICAgICBBVVJBX0FETUlOX1RPS0VOOiAhIShlbnYgJiYgZW52LkFVUkFfQURNSU5fVE9LRU4pLAogICAgICAgIEFVUkFfT1BFUkFUT1JfVE9LRU46ICEhKGVudiAmJiBlbnYuQVVSQV9PUEVSQVRPUl9UT0tFTiksCiAgICAgICAgQVVSQV9ERVBMT1lFUjogISEoZW52ICYmIGVudi5BVVJBX0RFUExPWUVSKSwKICAgICAgICBBVVJBX0tWOiAhIShlbnYgJiYgZW52LkFVUkFfS1YpCiAgICAgIH0sCiAgICAgIGhlYWRlcnNfc2VlbjogewogICAgICAgIGF1dGhvcml6YXRpb246IHJlcXVlc3QuaGVhZGVycy5nZXQoImF1dGhvcml6YXRpb24iKSwKICAgICAgICB4X2NvcmVfcGFzczogcmVxdWVzdC5oZWFkZXJzLmdldCgieC1jb3JlLXBhc3MiKSwKICAgICAgICB4X2RlcGxveV9rZXk6IHJlcXVlc3QuaGVhZGVycy5nZXQoIngtZGVwbG95LWtleSIpCiAgICAgIH0sCiAgICAgIG5vdGU6ICJURU1QIGRpYWdub3N0aWMgcm91dGUuIFJlbW92ZSBhZnRlciB1c2UuIgogICAgfSk7CiAgfQoKcmV0dXJuIGpzb24oeyBvazogZmFsc2UsIGVycm9yOiAibm90X2ZvdW5kIiwgcGF0aCB9LCA0MDQpOwogICAgfSBjYXRjaCAoZSkgewogICAgICByZXR1cm4ganNvbih7IG9rOiBmYWxzZSwgZXJyb3I6ICJ1bmhhbmRsZWRfZXhjZXB0aW9uIiwgZGV0YWlsOiBTdHJpbmcoZSAmJiBlLm1lc3NhZ2UgPyBlLm1lc3NhZ2UgOiBlKSB9LCA1MDApOwogICAgfQogIH0sCn07CgoKCgo=",
    "script_name":  "aura-core-staging"
}
